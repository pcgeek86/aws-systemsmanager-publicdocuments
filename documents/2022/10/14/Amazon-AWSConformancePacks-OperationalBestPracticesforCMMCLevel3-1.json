{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for CMMC Level 3\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"AccessKeysRotatedParamMaxAccessKeyAge\" : {\n        \"Default\" : \"90\",\n        \"Type\" : \"String\"\n      },\n      \"AcmCertificateExpirationCheckParamDaysToExpiration\" : {\n        \"Default\" : \"90\",\n        \"Type\" : \"String\"\n      },\n      \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyUnit\" : {\n        \"Default\" : \"days\",\n        \"Type\" : \"String\"\n      },\n      \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyValue\" : {\n        \"Default\" : \"1\",\n        \"Type\" : \"String\"\n      },\n      \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredRetentionDays\" : {\n        \"Default\" : \"35\",\n        \"Type\" : \"String\"\n      },\n      \"CwLoggroupRetentionPeriodCheckParamMinRetentionTime\" : {\n        \"Default\" : \"365\",\n        \"Type\" : \"String\"\n      },\n      \"Ec2VolumeInuseCheckParamDeleteOnTermination\" : {\n        \"Default\" : \"True\",\n        \"Type\" : \"String\"\n      },\n      \"GuarddutyNonArchivedFindingsParamDaysHighSev\" : {\n        \"Default\" : \"1\",\n        \"Type\" : \"String\"\n      },\n      \"GuarddutyNonArchivedFindingsParamDaysLowSev\" : {\n        \"Default\" : \"30\",\n        \"Type\" : \"String\"\n      },\n      \"GuarddutyNonArchivedFindingsParamDaysMediumSev\" : {\n        \"Default\" : \"7\",\n        \"Type\" : \"String\"\n      },\n      \"IamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Default\" : \"kms:Decrypt,kms:ReEncryptFrom\",\n        \"Type\" : \"String\"\n      },\n      \"IamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Default\" : \"kms:Decrypt,kms:ReEncryptFrom\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamMaxPasswordAge\" : {\n        \"Default\" : \"90\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamMinimumPasswordLength\" : {\n        \"Default\" : \"14\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamPasswordReusePrevention\" : {\n        \"Default\" : \"24\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamRequireLowercaseCharacters\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamRequireNumbers\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamRequireSymbols\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"IamPasswordPolicyParamRequireUppercaseCharacters\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"IamUserUnusedCredentialsCheckParamMaxCredentialUsageAge\" : {\n        \"Default\" : \"90\",\n        \"Type\" : \"String\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheckParamAutomatedSnapshotRetentionPeriod\" : {\n        \"Default\" : \"1\",\n        \"Type\" : \"String\"\n      },\n      \"RestrictedIncomingTrafficParamBlockedPort1\" : {\n        \"Default\" : \"20\",\n        \"Type\" : \"String\"\n      },\n      \"RestrictedIncomingTrafficParamBlockedPort2\" : {\n        \"Default\" : \"21\",\n        \"Type\" : \"String\"\n      },\n      \"RestrictedIncomingTrafficParamBlockedPort3\" : {\n        \"Default\" : \"3389\",\n        \"Type\" : \"String\"\n      },\n      \"RestrictedIncomingTrafficParamBlockedPort4\" : {\n        \"Default\" : \"3306\",\n        \"Type\" : \"String\"\n      },\n      \"RestrictedIncomingTrafficParamBlockedPort5\" : {\n        \"Default\" : \"4333\",\n        \"Type\" : \"String\"\n      },\n      \"VpcSgOpenOnlyToAuthorizedPortsParamAuthorizedTcpPorts\" : {\n        \"Default\" : \"443\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"AccessKeysRotated\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"access-keys-rotated\",\n          \"InputParameters\" : {\n            \"maxAccessKeyAge\" : {\n              \"Fn::If\" : [ \"accessKeysRotatedParamMaxAccessKeyAge\", {\n                \"Ref\" : \"AccessKeysRotatedParamMaxAccessKeyAge\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ACCESS_KEYS_ROTATED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AccountPartOfOrganizations\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"account-part-of-organizations\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ACCOUNT_PART_OF_ORGANIZATIONS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AcmCertificateExpirationCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"acm-certificate-expiration-check\",\n          \"InputParameters\" : {\n            \"daysToExpiration\" : {\n              \"Fn::If\" : [ \"acmCertificateExpirationCheckParamDaysToExpiration\", {\n                \"Ref\" : \"AcmCertificateExpirationCheckParamDaysToExpiration\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ACM::Certificate\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ACM_CERTIFICATE_EXPIRATION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AlbHttpDropInvalidHeaderEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"alb-http-drop-invalid-header-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancingV2::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ALB_HTTP_DROP_INVALID_HEADER_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AlbHttpToHttpsRedirectionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"alb-http-to-https-redirection-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ALB_HTTP_TO_HTTPS_REDIRECTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AlbWafEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"alb-waf-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancingV2::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ALB_WAF_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ApiGwAssociatedWithWaf\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-associated-with-waf\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_ASSOCIATED_WITH_WAF\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ApiGwCacheEnabledAndEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-cache-enabled-and-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_CACHE_ENABLED_AND_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ApiGwExecutionLoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-execution-logging-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\", \"AWS::ApiGatewayV2::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_EXECUTION_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ApiGwSslEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-ssl-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_SSL_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AutoscalingGroupElbHealthcheckRequired\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"autoscaling-group-elb-healthcheck-required\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::AutoScaling::AutoScalingGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AUTOSCALING_GROUP_ELB_HEALTHCHECK_REQUIRED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AutoscalingLaunchConfigPublicIpDisabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"autoscaling-launch-config-public-ip-disabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::AutoScaling::LaunchConfiguration\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AUTOSCALING_LAUNCH_CONFIG_PUBLIC_IP_DISABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"BackupPlanMinFrequencyAndMinRetentionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"backup-plan-min-frequency-and-min-retention-check\",\n          \"InputParameters\" : {\n            \"requiredFrequencyUnit\" : {\n              \"Fn::If\" : [ \"backupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyUnit\", {\n                \"Ref\" : \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyUnit\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"requiredFrequencyValue\" : {\n              \"Fn::If\" : [ \"backupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyValue\", {\n                \"Ref\" : \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyValue\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"requiredRetentionDays\" : {\n              \"Fn::If\" : [ \"backupPlanMinFrequencyAndMinRetentionCheckParamRequiredRetentionDays\", {\n                \"Ref\" : \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredRetentionDays\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Backup::BackupPlan\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"BACKUP_PLAN_MIN_FREQUENCY_AND_MIN_RETENTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudTrailCloudWatchLogsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloud-trail-cloud-watch-logs-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUD_TRAIL_CLOUD_WATCH_LOGS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudTrailEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudtrail-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUD_TRAIL_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudTrailEncryptionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloud-trail-encryption-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUD_TRAIL_ENCRYPTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudTrailLogFileValidationEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloud-trail-log-file-validation-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUD_TRAIL_LOG_FILE_VALIDATION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudtrailS3DataeventsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudtrail-s3-dataevents-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDTRAIL_S3_DATAEVENTS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudtrailSecurityTrailEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudtrail-security-trail-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDTRAIL_SECURITY_TRAIL_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudwatchAlarmActionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudwatch-alarm-action-check\",\n          \"InputParameters\" : {\n            \"alarmActionRequired\" : \"true\",\n            \"insufficientDataActionRequired\" : \"true\",\n            \"okActionRequired\" : \"false\"\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CloudWatch::Alarm\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDWATCH_ALARM_ACTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudwatchLogGroupEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudwatch-log-group-encrypted\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDWATCH_LOG_GROUP_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CmkBackingKeyRotationEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cmk-backing-key-rotation-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CMK_BACKING_KEY_ROTATION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CodebuildProjectEnvvarAwscredCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"codebuild-project-envvar-awscred-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CodeBuild::Project\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CODEBUILD_PROJECT_ENVVAR_AWSCRED_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CodebuildProjectSourceRepoUrlCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"codebuild-project-source-repo-url-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CodeBuild::Project\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CODEBUILD_PROJECT_SOURCE_REPO_URL_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CwLoggroupRetentionPeriodCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cw-loggroup-retention-period-check\",\n          \"InputParameters\" : {\n            \"MinRetentionTime\" : {\n              \"Fn::If\" : [ \"cwLoggroupRetentionPeriodCheckParamMinRetentionTime\", {\n                \"Ref\" : \"CwLoggroupRetentionPeriodCheckParamMinRetentionTime\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CW_LOGGROUP_RETENTION_PERIOD_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DbInstanceBackupEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"db-instance-backup-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DB_INSTANCE_BACKUP_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DmsReplicationNotPublic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dms-replication-not-public\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DMS_REPLICATION_NOT_PUBLIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbAutoscalingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-autoscaling-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::DynamoDB::Table\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_AUTOSCALING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbInBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-in-backup-plan\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_IN_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbPitrEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-pitr-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::DynamoDB::Table\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_PITR_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EbsInBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ebs-in-backup-plan\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EBS_IN_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EbsOptimizedInstance\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ebs-optimized-instance\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EBS_OPTIMIZED_INSTANCE\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EbsSnapshotPublicRestorableCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ebs-snapshot-public-restorable-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EBS_SNAPSHOT_PUBLIC_RESTORABLE_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2EbsEncryptionByDefault\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-ebs-encryption-by-default\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_EBS_ENCRYPTION_BY_DEFAULT\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2Imdsv2Check\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-imdsv2-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_IMDSV2_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceManagedBySsm\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-managed-by-systems-manager\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\", \"AWS::SSM::ManagedInstanceInventory\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_MANAGED_BY_SSM\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceNoPublicIp\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-no-public-ip\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_NO_PUBLIC_IP\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceProfileAttached\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-profile-attached\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_PROFILE_ATTACHED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2ManagedinstanceAssociationComplianceStatusCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-managedinstance-association-compliance-status-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SSM::AssociationCompliance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_MANAGEDINSTANCE_ASSOCIATION_COMPLIANCE_STATUS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2ManagedinstancePatchComplianceStatusCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-managedinstance-patch-compliance-status-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SSM::PatchCompliance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_MANAGEDINSTANCE_PATCH_COMPLIANCE_STATUS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2StoppedInstance\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-stopped-instance\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_STOPPED_INSTANCE\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2VolumeInuseCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-volume-inuse-check\",\n          \"InputParameters\" : {\n            \"deleteOnTermination\" : {\n              \"Fn::If\" : [ \"ec2VolumeInuseCheckParamDeleteOnTermination\", {\n                \"Ref\" : \"Ec2VolumeInuseCheckParamDeleteOnTermination\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Volume\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_VOLUME_INUSE_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EfsEncryptedCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"efs-encrypted-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EFS_ENCRYPTED_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EfsInBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"efs-in-backup-plan\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EFS_IN_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EipAttached\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"eip-attached\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::EIP\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EIP_ATTACHED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticBeanstalkManagedUpdatesEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elastic-beanstalk-managed-updates-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticBeanstalk::Environment\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTIC_BEANSTALK_MANAGED_UPDATES_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticacheRedisClusterAutomaticBackupCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticache-redis-cluster-automatic-backup-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICACHE_REDIS_CLUSTER_AUTOMATIC_BACKUP_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticsearchEncryptedAtRest\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticsearch-encrypted-at-rest\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICSEARCH_ENCRYPTED_AT_REST\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticsearchInVpcOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticsearch-in-vpc-only\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICSEARCH_IN_VPC_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticsearchNodeToNodeEncryptionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticsearch-node-to-node-encryption-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Elasticsearch::Domain\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbAcmCertificateRequired\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-acm-certificate-required\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancing::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_ACM_CERTIFICATE_REQUIRED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbCrossZoneLoadBalancingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-cross-zone-load-balancing-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancing::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_CROSS_ZONE_LOAD_BALANCING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbDeletionProtectionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-deletion-protection-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancingV2::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_DELETION_PROTECTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbLoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-logging-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancing::LoadBalancer\", \"AWS::ElasticLoadBalancingV2::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbTlsHttpsListenersOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-tls-https-listeners-only\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancing::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_TLS_HTTPS_LISTENERS_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Elbv2AcmCertificateRequired\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elbv2-acm-certificate-required\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELBV2_ACM_CERTIFICATE_REQUIRED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EmrKerberosEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"emr-kerberos-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EMR_KERBEROS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EmrMasterNoPublicIp\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"emr-master-no-public-ip\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EMR_MASTER_NO_PUBLIC_IP\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EncryptedVolumes\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"encrypted-volumes\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Volume\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ENCRYPTED_VOLUMES\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"GuarddutyEnabledCentralized\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"guardduty-enabled-centralized\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"GUARDDUTY_ENABLED_CENTRALIZED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"GuarddutyNonArchivedFindings\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"guardduty-non-archived-findings\",\n          \"InputParameters\" : {\n            \"daysHighSev\" : {\n              \"Fn::If\" : [ \"guarddutyNonArchivedFindingsParamDaysHighSev\", {\n                \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysHighSev\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"daysLowSev\" : {\n              \"Fn::If\" : [ \"guarddutyNonArchivedFindingsParamDaysLowSev\", {\n                \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysLowSev\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"daysMediumSev\" : {\n              \"Fn::If\" : [ \"guarddutyNonArchivedFindingsParamDaysMediumSev\", {\n                \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysMediumSev\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"GUARDDUTY_NON_ARCHIVED_FINDINGS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamCustomerPolicyBlockedKmsActions\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-customer-policy-blocked-kms-actions\",\n          \"InputParameters\" : {\n            \"blockedActionsPatterns\" : {\n              \"Fn::If\" : [ \"iamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\", {\n                \"Ref\" : \"IamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Policy\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_CUSTOMER_POLICY_BLOCKED_KMS_ACTIONS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamGroupHasUsersCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-group-has-users-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Group\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_GROUP_HAS_USERS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamInlinePolicyBlockedKmsActions\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-inline-policy-blocked-kms-actions\",\n          \"InputParameters\" : {\n            \"blockedActionsPatterns\" : {\n              \"Fn::If\" : [ \"iamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\", {\n                \"Ref\" : \"IamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Group\", \"AWS::IAM::Role\", \"AWS::IAM::User\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_INLINE_POLICY_BLOCKED_KMS_ACTIONS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamNoInlinePolicyCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-no-inline-policy-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::User\", \"AWS::IAM::Role\", \"AWS::IAM::Group\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_NO_INLINE_POLICY_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamPasswordPolicy\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-password-policy\",\n          \"InputParameters\" : {\n            \"MaxPasswordAge\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamMaxPasswordAge\", {\n                \"Ref\" : \"IamPasswordPolicyParamMaxPasswordAge\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"MinimumPasswordLength\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamMinimumPasswordLength\", {\n                \"Ref\" : \"IamPasswordPolicyParamMinimumPasswordLength\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"PasswordReusePrevention\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamPasswordReusePrevention\", {\n                \"Ref\" : \"IamPasswordPolicyParamPasswordReusePrevention\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"RequireLowercaseCharacters\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamRequireLowercaseCharacters\", {\n                \"Ref\" : \"IamPasswordPolicyParamRequireLowercaseCharacters\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"RequireNumbers\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamRequireNumbers\", {\n                \"Ref\" : \"IamPasswordPolicyParamRequireNumbers\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"RequireSymbols\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamRequireSymbols\", {\n                \"Ref\" : \"IamPasswordPolicyParamRequireSymbols\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"RequireUppercaseCharacters\" : {\n              \"Fn::If\" : [ \"iamPasswordPolicyParamRequireUppercaseCharacters\", {\n                \"Ref\" : \"IamPasswordPolicyParamRequireUppercaseCharacters\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_PASSWORD_POLICY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamPolicyNoStatementsWithAdminAccess\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-policy-no-statements-with-admin-access\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Policy\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_POLICY_NO_STATEMENTS_WITH_ADMIN_ACCESS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamPolicyNoStatementsWithFullAccess\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-policy-no-statements-with-full-access\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Policy\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_POLICY_NO_STATEMENTS_WITH_FULL_ACCESS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamRootAccessKeyCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-root-access-key-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_ROOT_ACCESS_KEY_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamUserGroupMembershipCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-user-group-membership-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::User\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_USER_GROUP_MEMBERSHIP_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamUserMfaEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-user-mfa-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_USER_MFA_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamUserNoPoliciesCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-user-no-policies-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::User\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_USER_NO_POLICIES_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamUserUnusedCredentialsCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-user-unused-credentials-check\",\n          \"InputParameters\" : {\n            \"maxCredentialUsageAge\" : {\n              \"Fn::If\" : [ \"iamUserUnusedCredentialsCheckParamMaxCredentialUsageAge\", {\n                \"Ref\" : \"IamUserUnusedCredentialsCheckParamMaxCredentialUsageAge\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_USER_UNUSED_CREDENTIALS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IncomingSshDisabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"restricted-ssh\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::SecurityGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"INCOMING_SSH_DISABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"InstancesInVpc\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instances-in-vpc\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"INSTANCES_IN_VPC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"InternetGatewayAuthorizedVpcOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"internet-gateway-authorized-vpc-only\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::InternetGateway\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"INTERNET_GATEWAY_AUTHORIZED_VPC_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"KmsCmkNotScheduledForDeletion\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"kms-cmk-not-scheduled-for-deletion\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::KMS::Key\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"KMS_CMK_NOT_SCHEDULED_FOR_DELETION\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaDlqCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-dlq-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_DLQ_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaFunctionPublicAccessProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-function-public-access-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_FUNCTION_PUBLIC_ACCESS_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaInsideVpc\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-inside-vpc\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_INSIDE_VPC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"MfaEnabledForIamConsoleAccess\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"mfa-enabled-for-iam-console-access\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"MFA_ENABLED_FOR_IAM_CONSOLE_ACCESS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"MultiRegionCloudTrailEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"multi-region-cloudtrail-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"MULTI_REGION_CLOUD_TRAIL_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"NoUnrestrictedRouteToIgw\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"no-unrestricted-route-to-igw\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::RouteTable\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"NO_UNRESTRICTED_ROUTE_TO_IGW\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsAutomaticMinorVersionUpgradeEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-automatic-minor-version-upgrade-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_AUTOMATIC_MINOR_VERSION_UPGRADE_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-in-backup-plan\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_IN_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInstanceDeletionProtectionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-instance-deletion-protection-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_INSTANCE_DELETION_PROTECTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInstancePublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-instance-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_INSTANCE_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsLoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-logging-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsMultiAzSupport\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-multi-az-support\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_MULTI_AZ_SUPPORT\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsSnapshotEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-snapshot-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBSnapshot\", \"AWS::RDS::DBClusterSnapshot\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_SNAPSHOT_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsSnapshotsPublicProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-snapshots-public-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBSnapshot\", \"AWS::RDS::DBClusterSnapshot\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_SNAPSHOTS_PUBLIC_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsStorageEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-storage-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_STORAGE_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftBackupEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-backup-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_BACKUP_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterKmsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-kms-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_KMS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-maintenancesettings-check\",\n          \"InputParameters\" : {\n            \"allowVersionUpgrade\" : {\n              \"Fn::If\" : [ \"redshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\", {\n                \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"automatedSnapshotRetentionPeriod\" : {\n              \"Fn::If\" : [ \"redshiftClusterMaintenancesettingsCheckParamAutomatedSnapshotRetentionPeriod\", {\n                \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAutomatedSnapshotRetentionPeriod\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_MAINTENANCESETTINGS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterPublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftRequireTlsSsl\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-require-tls-ssl\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_REQUIRE_TLS_SSL\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RestrictedIncomingTraffic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"restricted-common-ports\",\n          \"InputParameters\" : {\n            \"blockedPort1\" : {\n              \"Fn::If\" : [ \"restrictedIncomingTrafficParamBlockedPort1\", {\n                \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort1\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"blockedPort2\" : {\n              \"Fn::If\" : [ \"restrictedIncomingTrafficParamBlockedPort2\", {\n                \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort2\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"blockedPort3\" : {\n              \"Fn::If\" : [ \"restrictedIncomingTrafficParamBlockedPort3\", {\n                \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort3\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"blockedPort4\" : {\n              \"Fn::If\" : [ \"restrictedIncomingTrafficParamBlockedPort4\", {\n                \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort4\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"blockedPort5\" : {\n              \"Fn::If\" : [ \"restrictedIncomingTrafficParamBlockedPort5\", {\n                \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort5\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::SecurityGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RESTRICTED_INCOMING_TRAFFIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RootAccountHardwareMfaEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"root-account-hardware-mfa-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ROOT_ACCOUNT_HARDWARE_MFA_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RootAccountMfaEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"root-account-mfa-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ROOT_ACCOUNT_MFA_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3AccountLevelPublicAccessBlocksPeriodic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-account-level-public-access-blocks-periodic\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_ACCOUNT_LEVEL_PUBLIC_ACCESS_BLOCKS_PERIODIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketDefaultLockEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-default-lock-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_DEFAULT_LOCK_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketLevelPublicAccessProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-level-public-access-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_LEVEL_PUBLIC_ACCESS_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketLoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-logging-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketPolicyGranteeCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-policy-grantee-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_POLICY_GRANTEE_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketPublicReadProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-public-read-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_PUBLIC_READ_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketPublicWriteProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-public-write-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_PUBLIC_WRITE_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketReplicationEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-replication-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_REPLICATION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketServerSideEncryptionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-server-side-encryption-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketSslRequestsOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-ssl-requests-only\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_SSL_REQUESTS_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketVersioningEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-versioning-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_VERSIONING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3DefaultEncryptionKms\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-default-encryption-kms\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_DEFAULT_ENCRYPTION_KMS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SagemakerEndpointConfigurationKmsKeyConfigured\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sagemaker-endpoint-configuration-kms-key-configured\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SAGEMAKER_ENDPOINT_CONFIGURATION_KMS_KEY_CONFIGURED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SagemakerNotebookInstanceKmsKeyConfigured\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sagemaker-notebook-instance-kms-key-configured\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SAGEMAKER_NOTEBOOK_INSTANCE_KMS_KEY_CONFIGURED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SagemakerNotebookNoDirectInternetAccess\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sagemaker-notebook-no-direct-internet-access\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SAGEMAKER_NOTEBOOK_NO_DIRECT_INTERNET_ACCESS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SecretsmanagerRotationEnabledCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"secretsmanager-rotation-enabled-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SecretsManager::Secret\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SECRETSMANAGER_ROTATION_ENABLED_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SecretsmanagerScheduledRotationSuccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"secretsmanager-scheduled-rotation-success-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SecretsManager::Secret\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SECRETSMANAGER_SCHEDULED_ROTATION_SUCCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SecurityhubEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"securityhub-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SECURITYHUB_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SnsEncryptedKms\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sns-encrypted-kms\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SNS::Topic\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SNS_ENCRYPTED_KMS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SsmDocumentNotPublic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ssm-document-not-public\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SSM_DOCUMENT_NOT_PUBLIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SubnetAutoAssignPublicIpDisabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"subnet-auto-assign-public-ip-disabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Subnet\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SUBNET_AUTO_ASSIGN_PUBLIC_IP_DISABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"VpcDefaultSecurityGroupClosed\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"vpc-default-security-group-closed\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::SecurityGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"VPC_DEFAULT_SECURITY_GROUP_CLOSED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"VpcSgOpenOnlyToAuthorizedPorts\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"vpc-sg-open-only-to-authorized-ports\",\n          \"InputParameters\" : {\n            \"authorizedTcpPorts\" : {\n              \"Fn::If\" : [ \"vpcSgOpenOnlyToAuthorizedPortsParamAuthorizedTcpPorts\", {\n                \"Ref\" : \"VpcSgOpenOnlyToAuthorizedPortsParamAuthorizedTcpPorts\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::SecurityGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"VPC_SG_OPEN_ONLY_TO_AUTHORIZED_PORTS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"VpcVpn2TunnelsUp\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"vpc-vpn-2-tunnels-up\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::VPNConnection\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"VPC_VPN_2_TUNNELS_UP\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Wafv2LoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"wafv2-logging-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"WAFV2_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ResponsePlanExistsMaintained\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"response-plan-exists-maintained\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AWS_CONFIG_PROCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ResponsePlanTested\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"response-plan-tested\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AWS_CONFIG_PROCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"VulnScansPerformed\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"vuln-scans-performed\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AWS_CONFIG_PROCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"VulnManagementPlanExists\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"vuln-management-plan-exists\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AWS_CONFIG_PROCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    },\n    \"Conditions\" : {\n      \"accessKeysRotatedParamMaxAccessKeyAge\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"AccessKeysRotatedParamMaxAccessKeyAge\"\n          } ]\n        } ]\n      },\n      \"acmCertificateExpirationCheckParamDaysToExpiration\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"AcmCertificateExpirationCheckParamDaysToExpiration\"\n          } ]\n        } ]\n      },\n      \"backupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyUnit\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyUnit\"\n          } ]\n        } ]\n      },\n      \"backupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyValue\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredFrequencyValue\"\n          } ]\n        } ]\n      },\n      \"backupPlanMinFrequencyAndMinRetentionCheckParamRequiredRetentionDays\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"BackupPlanMinFrequencyAndMinRetentionCheckParamRequiredRetentionDays\"\n          } ]\n        } ]\n      },\n      \"cwLoggroupRetentionPeriodCheckParamMinRetentionTime\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"CwLoggroupRetentionPeriodCheckParamMinRetentionTime\"\n          } ]\n        } ]\n      },\n      \"ec2VolumeInuseCheckParamDeleteOnTermination\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"Ec2VolumeInuseCheckParamDeleteOnTermination\"\n          } ]\n        } ]\n      },\n      \"guarddutyNonArchivedFindingsParamDaysHighSev\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysHighSev\"\n          } ]\n        } ]\n      },\n      \"guarddutyNonArchivedFindingsParamDaysLowSev\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysLowSev\"\n          } ]\n        } ]\n      },\n      \"guarddutyNonArchivedFindingsParamDaysMediumSev\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysMediumSev\"\n          } ]\n        } ]\n      },\n      \"iamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n          } ]\n        } ]\n      },\n      \"iamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamMaxPasswordAge\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamMaxPasswordAge\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamMinimumPasswordLength\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamMinimumPasswordLength\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamPasswordReusePrevention\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamPasswordReusePrevention\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamRequireLowercaseCharacters\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamRequireLowercaseCharacters\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamRequireNumbers\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamRequireNumbers\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamRequireSymbols\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamRequireSymbols\"\n          } ]\n        } ]\n      },\n      \"iamPasswordPolicyParamRequireUppercaseCharacters\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamPasswordPolicyParamRequireUppercaseCharacters\"\n          } ]\n        } ]\n      },\n      \"iamUserUnusedCredentialsCheckParamMaxCredentialUsageAge\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamUserUnusedCredentialsCheckParamMaxCredentialUsageAge\"\n          } ]\n        } ]\n      },\n      \"redshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\"\n          } ]\n        } ]\n      },\n      \"redshiftClusterMaintenancesettingsCheckParamAutomatedSnapshotRetentionPeriod\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAutomatedSnapshotRetentionPeriod\"\n          } ]\n        } ]\n      },\n      \"restrictedIncomingTrafficParamBlockedPort1\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort1\"\n          } ]\n        } ]\n      },\n      \"restrictedIncomingTrafficParamBlockedPort2\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort2\"\n          } ]\n        } ]\n      },\n      \"restrictedIncomingTrafficParamBlockedPort3\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort3\"\n          } ]\n        } ]\n      },\n      \"restrictedIncomingTrafficParamBlockedPort4\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort4\"\n          } ]\n        } ]\n      },\n      \"restrictedIncomingTrafficParamBlockedPort5\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RestrictedIncomingTrafficParamBlockedPort5\"\n          } ]\n        } ]\n      },\n      \"vpcSgOpenOnlyToAuthorizedPortsParamAuthorizedTcpPorts\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"VpcSgOpenOnlyToAuthorizedPortsParamAuthorizedTcpPorts\"\n          } ]\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:47:15.435Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforCMMCLevel3",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "6598ddc3-dcd8-4c60-bfb0-d5bca77b670f",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 75477,
  "HttpStatusCode": 200,
  "LoggedAt": "2022-10-14T07:34:10.0841358+00:00"
}
