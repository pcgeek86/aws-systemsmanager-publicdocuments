{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for Publicly Accessible Resources\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"S3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicAcls\" : {\n        \"Default\" : \"True\",\n        \"Type\" : \"String\"\n      },\n      \"S3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicPolicy\" : {\n        \"Default\" : \"True\",\n        \"Type\" : \"String\"\n      },\n      \"S3AccountLevelPublicAccessBlocksPeriodicParamIgnorePublicAcls\" : {\n        \"Default\" : \"True\",\n        \"Type\" : \"String\"\n      },\n      \"S3AccountLevelPublicAccessBlocksPeriodicParamRestrictPublicBuckets\" : {\n        \"Default\" : \"True\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"AutoscalingLaunchConfigPublicIpDisabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"autoscaling-launch-config-public-ip-disabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::AutoScaling::LaunchConfiguration\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AUTOSCALING_LAUNCH_CONFIG_PUBLIC_IP_DISABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DmsReplicationNotPublic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dms-replication-not-public\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DMS_REPLICATION_NOT_PUBLIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EbsSnapshotPublicRestorableCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ebs-snapshot-public-restorable-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EBS_SNAPSHOT_PUBLIC_RESTORABLE_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceNoPublicIp\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-no-public-ip\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_NO_PUBLIC_IP\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticsearchInVpcOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticsearch-in-vpc-only\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICSEARCH_IN_VPC_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EmrMasterNoPublicIp\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"emr-master-no-public-ip\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EMR_MASTER_NO_PUBLIC_IP\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"InstancesInVpc\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instances-in-vpc\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"INSTANCES_IN_VPC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaFunctionPublicAccessProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-function-public-access-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_FUNCTION_PUBLIC_ACCESS_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaInsideVpc\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-inside-vpc\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_INSIDE_VPC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInstancePublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-instance-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_INSTANCE_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsSnapshotsPublicProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-snapshots-public-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBSnapshot\", \"AWS::RDS::DBClusterSnapshot\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_SNAPSHOTS_PUBLIC_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterPublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3AccountLevelPublicAccessBlocksPeriodic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-account-level-public-access-blocks-periodic\",\n          \"InputParameters\" : {\n            \"BlockPublicAcls\" : {\n              \"Fn::If\" : [ \"s3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicAcls\", {\n                \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicAcls\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"BlockPublicPolicy\" : {\n              \"Fn::If\" : [ \"s3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicPolicy\", {\n                \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicPolicy\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"IgnorePublicAcls\" : {\n              \"Fn::If\" : [ \"s3AccountLevelPublicAccessBlocksPeriodicParamIgnorePublicAcls\", {\n                \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamIgnorePublicAcls\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"RestrictPublicBuckets\" : {\n              \"Fn::If\" : [ \"s3AccountLevelPublicAccessBlocksPeriodicParamRestrictPublicBuckets\", {\n                \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamRestrictPublicBuckets\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_ACCOUNT_LEVEL_PUBLIC_ACCESS_BLOCKS_PERIODIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketLevelPublicAccessProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-level-public-access-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_LEVEL_PUBLIC_ACCESS_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketPublicReadProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-public-read-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_PUBLIC_READ_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketPublicWriteProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-public-write-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_PUBLIC_WRITE_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SagemakerNotebookNoDirectInternetAccess\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sagemaker-notebook-no-direct-internet-access\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SAGEMAKER_NOTEBOOK_NO_DIRECT_INTERNET_ACCESS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SsmDocumentNotPublic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ssm-document-not-public\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SSM_DOCUMENT_NOT_PUBLIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SubnetAutoAssignPublicIpDisabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"subnet-auto-assign-public-ip-disabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Subnet\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SUBNET_AUTO_ASSIGN_PUBLIC_IP_DISABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    },\n    \"Conditions\" : {\n      \"s3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicAcls\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicAcls\"\n          } ]\n        } ]\n      },\n      \"s3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicPolicy\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamBlockPublicPolicy\"\n          } ]\n        } ]\n      },\n      \"s3AccountLevelPublicAccessBlocksPeriodicParamIgnorePublicAcls\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamIgnorePublicAcls\"\n          } ]\n        } ]\n      },\n      \"s3AccountLevelPublicAccessBlocksPeriodicParamRestrictPublicBuckets\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"S3AccountLevelPublicAccessBlocksPeriodicParamRestrictPublicBuckets\"\n          } ]\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:52:35.434Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforPubliclyAccessibleResources",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "75b6eea4-4b1f-43d1-9e0e-77168a2b2931",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 11888,
  "HttpStatusCode": 200,
  "LoggedAt": "2023-03-07T07:11:17.7232702+00:00"
}
