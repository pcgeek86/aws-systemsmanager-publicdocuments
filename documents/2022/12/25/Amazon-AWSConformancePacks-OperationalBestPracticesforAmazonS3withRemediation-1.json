{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for Amazon S3 with Remediation\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"S3TargetBucketNameForEnableLogging\" : {\n        \"Description\" : \"The target s3 bucket where the logging should be enabled.\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"S3BucketPublicReadProhibited\" : {\n        \"Type\" : \"AWS::Config::ConfigRule\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketPublicReadProhibited\",\n          \"Description\" : \"Checks that your Amazon S3 buckets do not allow public read access. The rule checks the Block Public Access settings, the bucket policy, and the bucket access control list (ACL).\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_PUBLIC_READ_PROHIBITED\"\n          },\n          \"MaximumExecutionFrequency\" : \"Six_Hours\"\n        }\n      },\n      \"S3BucketPublicReadProhibitedRemediation\" : {\n        \"DependsOn\" : \"S3BucketPublicReadProhibited\",\n        \"Type\" : \"AWS::Config::RemediationConfiguration\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketPublicReadProhibited\",\n          \"ResourceType\" : \"AWS::S3::Bucket\",\n          \"TargetId\" : \"AWS-DisableS3BucketPublicReadWrite\",\n          \"TargetType\" : \"SSM_DOCUMENT\",\n          \"TargetVersion\" : \"1\",\n          \"Parameters\" : {\n            \"AutomationAssumeRole\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"arn:aws:iam::<Account-Id>:role/S3OperationsAutomationsExecutionRole\" ]\n              }\n            },\n            \"S3BucketName\" : {\n              \"ResourceValue\" : {\n                \"Value\" : \"RESOURCE_ID\"\n              }\n            }\n          },\n          \"ExecutionControls\" : {\n            \"SsmControls\" : {\n              \"ConcurrentExecutionRatePercentage\" : 10,\n              \"ErrorPercentage\" : 10\n            }\n          },\n          \"Automatic\" : true,\n          \"MaximumAutomaticAttempts\" : 10,\n          \"RetryAttemptSeconds\" : 600\n        }\n      },\n      \"S3BucketPublicWriteProhibited\" : {\n        \"Type\" : \"AWS::Config::ConfigRule\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketPublicWriteProhibited\",\n          \"Description\" : \"Checks that your Amazon S3 buckets do not allow public write access. The rule checks the Block Public Access settings, the bucket policy, and the bucket access control list (ACL).\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_PUBLIC_WRITE_PROHIBITED\"\n          },\n          \"MaximumExecutionFrequency\" : \"Six_Hours\"\n        }\n      },\n      \"S3BucketPublicWriteProhibitedRemediation\" : {\n        \"DependsOn\" : \"S3BucketPublicWriteProhibited\",\n        \"Type\" : \"AWS::Config::RemediationConfiguration\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketPublicWriteProhibited\",\n          \"ResourceType\" : \"AWS::S3::Bucket\",\n          \"TargetId\" : \"AWS-DisableS3BucketPublicReadWrite\",\n          \"TargetType\" : \"SSM_DOCUMENT\",\n          \"TargetVersion\" : \"1\",\n          \"Parameters\" : {\n            \"AutomationAssumeRole\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"arn:aws:iam::<Account-Id>:role/S3OperationsAutomationsExecutionRole\" ]\n              }\n            },\n            \"S3BucketName\" : {\n              \"ResourceValue\" : {\n                \"Value\" : \"RESOURCE_ID\"\n              }\n            }\n          },\n          \"ExecutionControls\" : {\n            \"SsmControls\" : {\n              \"ConcurrentExecutionRatePercentage\" : 10,\n              \"ErrorPercentage\" : 10\n            }\n          },\n          \"Automatic\" : true,\n          \"MaximumAutomaticAttempts\" : 10,\n          \"RetryAttemptSeconds\" : 600\n        }\n      },\n      \"S3BucketReplicationEnabled\" : {\n        \"Type\" : \"AWS::Config::ConfigRule\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketReplicationEnabled\",\n          \"Description\" : \"Checks whether the Amazon S3 buckets have cross-region replication enabled.\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_REPLICATION_ENABLED\"\n          }\n        }\n      },\n      \"S3BucketSSLRequestsOnly\" : {\n        \"Type\" : \"AWS::Config::ConfigRule\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketSSLRequestsOnly\",\n          \"Description\" : \"Checks whether S3 buckets have policies that require requests to use Secure Socket Layer (SSL).\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_SSL_REQUESTS_ONLY\"\n          }\n        }\n      },\n      \"S3BucketServerSideEncryptionEnabled\" : {\n        \"Type\" : \"AWS::Config::ConfigRule\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketServerSideEncryptionEnabled\",\n          \"Description\" : \"Checks that your Amazon S3 bucket either has S3 default encryption enabled or that the S3 bucket policy explicitly denies put-object requests without server side encryption.\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED\"\n          }\n        }\n      },\n      \"S3BucketServerSideEncryptionEnabledRemediation\" : {\n        \"DependsOn\" : \"S3BucketServerSideEncryptionEnabled\",\n        \"Type\" : \"AWS::Config::RemediationConfiguration\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketServerSideEncryptionEnabled\",\n          \"ResourceType\" : \"AWS::S3::Bucket\",\n          \"TargetId\" : \"AWS-EnableS3BucketEncryption\",\n          \"TargetType\" : \"SSM_DOCUMENT\",\n          \"TargetVersion\" : \"1\",\n          \"Parameters\" : {\n            \"AutomationAssumeRole\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"arn:aws:iam::<Account-Id>:role/S3OperationsAutomationsExecutionRole\" ]\n              }\n            },\n            \"BucketName\" : {\n              \"ResourceValue\" : {\n                \"Value\" : \"RESOURCE_ID\"\n              }\n            },\n            \"SSEAlgorithm\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"AES256\" ]\n              }\n            }\n          },\n          \"ExecutionControls\" : {\n            \"SsmControls\" : {\n              \"ConcurrentExecutionRatePercentage\" : 10,\n              \"ErrorPercentage\" : 10\n            }\n          },\n          \"Automatic\" : true,\n          \"MaximumAutomaticAttempts\" : 10,\n          \"RetryAttemptSeconds\" : 600\n        }\n      },\n      \"S3BucketLoggingEnabled\" : {\n        \"Type\" : \"AWS::Config::ConfigRule\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketLoggingEnabled\",\n          \"Description\" : \"Checks whether logging is enabled for your S3 buckets.\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_LOGGING_ENABLED\"\n          }\n        }\n      },\n      \"S3BucketLoggingEnabledRemediation\" : {\n        \"DependsOn\" : \"S3BucketLoggingEnabled\",\n        \"Type\" : \"AWS::Config::RemediationConfiguration\",\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"S3BucketLoggingEnabled\",\n          \"ResourceType\" : \"AWS::S3::Bucket\",\n          \"TargetId\" : \"AWS-ConfigureS3BucketLogging\",\n          \"TargetType\" : \"SSM_DOCUMENT\",\n          \"TargetVersion\" : \"1\",\n          \"Parameters\" : {\n            \"AutomationAssumeRole\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"arn:aws:iam::<Account-Id>:role/S3OperationsAutomationsExecutionRole\" ]\n              }\n            },\n            \"BucketName\" : {\n              \"ResourceValue\" : {\n                \"Value\" : \"RESOURCE_ID\"\n              }\n            },\n            \"TargetBucket\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ {\n                  \"Ref\" : \"S3TargetBucketNameForEnableLogging\"\n                } ]\n              }\n            },\n            \"GrantedPermission\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"FULL_CONTROL\" ]\n              }\n            },\n            \"GranteeType\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"Group\" ]\n              }\n            },\n            \"GranteeUri\" : {\n              \"StaticValue\" : {\n                \"Values\" : [ \"http://acs.amazonaws.com/groups/s3/LogDelivery\" ]\n              }\n            }\n          },\n          \"ExecutionControls\" : {\n            \"SsmControls\" : {\n              \"ConcurrentExecutionRatePercentage\" : 10,\n              \"ErrorPercentage\" : 10\n            }\n          },\n          \"Automatic\" : true,\n          \"MaximumAutomaticAttempts\" : 10,\n          \"RetryAttemptSeconds\" : 600\n        }\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:44:35.434Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforAmazonS3withRemediation",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "6fc28bf7-58fe-4eac-96f6-f5988574a830",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 10170,
  "HttpStatusCode": 200,
  "LoggedAt": "2022-12-25T07:10:21.8496059+00:00"
}
