{
  "AttachmentsContent": [],
  "Content": "{\n  \"description\" : \"Security Best Practices for Redshift\",\n  \"schemaVersion\" : \"1.0\",\n  \"templateBody\" : {\n    \"Conditions\" : {\n      \"redshiftClusterConfigurationCheckParamClusterDbEncrypted\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RedshiftClusterConfigurationCheckParamClusterDbEncrypted\"\n          } ]\n        } ]\n      },\n      \"redshiftClusterConfigurationCheckParamLoggingEnabled\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RedshiftClusterConfigurationCheckParamLoggingEnabled\"\n          } ]\n        } ]\n      },\n      \"redshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\"\n          } ]\n        } ]\n      }\n    },\n    \"Parameters\" : {\n      \"RedshiftClusterConfigurationCheckParamClusterDbEncrypted\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"RedshiftClusterConfigurationCheckParamLoggingEnabled\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\" : {\n        \"Default\" : \"true\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"RedshiftBackupEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-backup-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_BACKUP_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterConfigurationCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-configuration-check\",\n          \"InputParameters\" : {\n            \"clusterDbEncrypted\" : {\n              \"Fn::If\" : [ \"redshiftClusterConfigurationCheckParamClusterDbEncrypted\", {\n                \"Ref\" : \"RedshiftClusterConfigurationCheckParamClusterDbEncrypted\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"loggingEnabled\" : {\n              \"Fn::If\" : [ \"redshiftClusterConfigurationCheckParamLoggingEnabled\", {\n                \"Ref\" : \"RedshiftClusterConfigurationCheckParamLoggingEnabled\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_CONFIGURATION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterKmsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-kms-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_KMS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-maintenancesettings-check\",\n          \"InputParameters\" : {\n            \"allowVersionUpgrade\" : {\n              \"Fn::If\" : [ \"redshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\", {\n                \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_MAINTENANCESETTINGS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterPublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftDefaultAdminCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-default-admin-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_DEFAULT_ADMIN_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftDefaultDbNameCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-default-db-name-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_DEFAULT_DB_NAME_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftEnhancedVpcRoutingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-enhanced-vpc-routing-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_ENHANCED_VPC_ROUTING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftRequireTlsSsl\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-require-tls-ssl\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_REQUIRE_TLS_SSL\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:54:51.436Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-SecurityBestPracticesforRedshift",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "24004b19-03e6-411e-98b6-f41d7e5c1f3a",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 6951,
  "HttpStatusCode": 200,
  "LoggedAt": "2022-09-09T07:21:03.2572401+00:00"
}
