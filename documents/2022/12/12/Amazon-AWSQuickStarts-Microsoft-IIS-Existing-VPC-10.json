{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"This AWS CloudFormation template demonstrates one way to configure Windows workloads in Auto Scaling groups on the AWS Cloud. It installs and configures IIS to display a simple static page, with Amazon CloudWatch collecting metrics and compiling logs and AWS Systems Manager configuring the instances. Scenario 1 launches a scalable IIS environment based on a launch template, Application Load Balancer, and Auto Scaling group. Configuration while scaling is handled by lifecycle hooks, Amazon EventBridge, and AWS System Manager automation. (qs-1r91fg4hm)\",\n  \"templateBody\" : {\n    \"AWSTemplateFormatVersion\" : \"2010-09-09\",\n    \"Description\" : \"This AWS CloudFormation template demonstrates one way to configure Windows workloads in Auto Scaling groups on the AWS Cloud. It installs and configures IIS to display a simple static page, with Amazon CloudWatch collecting metrics and compiling logs and AWS Systems Manager configuring the instances. Scenario 1 launches a scalable IIS environment based on a launch template, Application Load Balancer, and Auto Scaling group. Configuration while scaling is handled by lifecycle hooks, Amazon EventBridge, and AWS System Manager automation. (qs-1r91fg4hm)\",\n    \"Metadata\" : {\n      \"QuickStartDocumentation\" : {\n        \"EntrypointName\" : \"Deploy into an existing VPC\",\n        \"Order\" : \"2\"\n      },\n      \"AWS::CloudFormation::Interface\" : {\n        \"ParameterGroups\" : [ {\n          \"Label\" : {\n            \"default\" : \"Deployment Type\"\n          },\n          \"Parameters\" : [ \"DeploymentType\", \"ECSImage\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"Active Directory information\"\n          },\n          \"Parameters\" : [ \"DomainDNSName\", \"DomainNetBIOSName\", \"DomainAdminUser\", \"DomainAdminPassword\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"Auto Scaling group / Application Load Balancer configuration\"\n          },\n          \"Parameters\" : [ \"ASGDesiredCapacity\", \"ASGMaxSize\", \"ASGMinSize\", \"ELBSchemeParameter\", \"IISServerInstanceType\", \"WebAccessCIDR\", \"SetupAppInsightsMonitoring\", \"AppInsightsApplicationName\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"IIS Webpage\"\n          },\n          \"Parameters\" : [ \"WebBucketName\", \"WebBucketKey\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"Network configuration\"\n          },\n          \"Parameters\" : [ \"VPCID\", \"DomainMemberSecurityGroup\", \"PrivateSubnet1ID\", \"PrivateSubnet2ID\", \"ELBSubnet1ID\", \"ELBSubnet2ID\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"AWS Quick Start configuration\"\n          },\n          \"Parameters\" : [ \"QSS3BucketName\", \"QSS3KeyPrefix\" ]\n        } ],\n        \"ParameterLabels\" : {\n          \"AppInsightsApplicationName\" : {\n            \"default\" : \"Registered application name\"\n          },\n          \"ASGDesiredCapacity\" : {\n            \"default\" : \"Auto Scaling group desired capacity\"\n          },\n          \"ASGMaxSize\" : {\n            \"default\" : \"Auto Scaling group maximum size\"\n          },\n          \"ASGMinSize\" : {\n            \"default\" : \"Auto Scaling group minimum size\"\n          },\n          \"DeploymentType\" : {\n            \"default\" : \"Deployment type for IIS\"\n          },\n          \"DomainDNSName\" : {\n            \"default\" : \"Domain DNS name\"\n          },\n          \"DomainNetBIOSName\" : {\n            \"default\" : \"Domain NetBIOS name\"\n          },\n          \"DomainAdminUser\" : {\n            \"default\" : \"Domain administrator name\"\n          },\n          \"DomainAdminPassword\" : {\n            \"default\" : \"Domain administrator password\"\n          },\n          \"DomainMemberSecurityGroup\" : {\n            \"default\" : \"Security group with access to domain\"\n          },\n          \"ECSImage\" : {\n            \"default\" : \"ECS Container Image\"\n          },\n          \"ELBSchemeParameter\" : {\n            \"default\" : \"Elastic Load Balancing scheme\"\n          },\n          \"ELBSubnet1ID\" : {\n            \"default\" : \"Elastic Load Balancer subnet\"\n          },\n          \"ELBSubnet2ID\" : {\n            \"default\" : \"Elastic Load Balancer subnet\"\n          },\n          \"IISServerInstanceType\" : {\n            \"default\" : \"IIS server instance type\"\n          },\n          \"PrivateSubnet1ID\" : {\n            \"default\" : \"Private subnet\"\n          },\n          \"PrivateSubnet2ID\" : {\n            \"default\" : \"Private subnet\"\n          },\n          \"QSS3BucketName\" : {\n            \"default\" : \"Quick Start S3 bucket name\"\n          },\n          \"QSS3KeyPrefix\" : {\n            \"default\" : \"Quick Start S3 key prefix\"\n          },\n          \"SetupAppInsightsMonitoring\" : {\n            \"default\" : \"Setup Application Insights monitoring\"\n          },\n          \"WebAccessCIDR\" : {\n            \"default\" : \"Elastic Load Balancer CIDR range\"\n          },\n          \"WebBucketName\" : {\n            \"default\" : \"S3 Bucket Webpage Location\"\n          },\n          \"WebBucketKey\" : {\n            \"default\" : \"S3 Key Webpage Location\"\n          },\n          \"VPCID\" : {\n            \"default\" : \"VPC ID for workload\"\n          }\n        }\n      }\n    },\n    \"Parameters\" : {\n      \"AppInsightsApplicationName\" : {\n        \"Description\" : \"Application name to be used with AppInsights monitoring\",\n        \"Type\" : \"String\",\n        \"Default\" : \"\",\n        \"MaxLength\" : \"300\",\n        \"AllowedPattern\" : \"^[a-zA-Z0-9\\\\-]*$\"\n      },\n      \"ASGMinSize\" : {\n        \"Default\" : 2,\n        \"Type\" : \"Number\",\n        \"Description\" : \"Minimum instance size for the Auto Scaling group.\"\n      },\n      \"ASGMaxSize\" : {\n        \"Default\" : 4,\n        \"Type\" : \"Number\",\n        \"Description\" : \"Maximum instance size for the Auto Scaling group.\"\n      },\n      \"ASGDesiredCapacity\" : {\n        \"Default\" : 2,\n        \"Type\" : \"Number\",\n        \"Description\" : \"Desired capacity of the Auto Scaling group.\"\n      },\n      \"DeploymentType\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"Deploy IIS on EC2 Or ECS\",\n        \"Default\" : \"EC2\",\n        \"AllowedValues\" : [ \"EC2\", \"ECS\" ]\n      },\n      \"DomainAdminPassword\" : {\n        \"AllowedPattern\" : \"(?=^.{8,32}$)((?=.*\\\\d)(?=.*[A-Z])(?=.*[a-z])|(?=.*\\\\d)(?=.*[^A-Za-z0-9])(?=.*[a-z])|(?=.*[^A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z])|(?=.*\\\\d)(?=.*[A-Z])(?=.*[^A-Za-z0-9]))^.*\",\n        \"Description\" : \"Password for the domain administrator. It must be at least 8 characters and contain letters, numbers, and symbols.\",\n        \"MaxLength\" : \"32\",\n        \"MinLength\" : \"8\",\n        \"NoEcho\" : \"true\",\n        \"Type\" : \"String\"\n      },\n      \"DomainAdminUser\" : {\n        \"AllowedPattern\" : \"^[a-zA-Z0-9]+$\",\n        \"Default\" : \"Admin\",\n        \"Description\" : \"User name for the account that will be used as domain administrator. This is separate from the default Administrator account.\",\n        \"MaxLength\" : \"25\",\n        \"MinLength\" : \"5\",\n        \"Type\" : \"String\"\n      },\n      \"DomainDNSName\" : {\n        \"AllowedPattern\" : \"^[a-zA-Z0-9]+[a-zA-Z0-9\\\\-]*\\\\.[a-zA-Z0-9]+$\",\n        \"Default\" : \"example.com\",\n        \"Description\" : \"Fully qualified domain name (FQDN).\",\n        \"MaxLength\" : \"64\",\n        \"MinLength\" : \"2\",\n        \"Type\" : \"String\"\n      },\n      \"DomainNetBIOSName\" : {\n        \"AllowedPattern\" : \"^[a-zA-Z0-9]+$\",\n        \"Default\" : \"EXAMPLE\",\n        \"Description\" : \"NetBIOS name of the domain (up to 15 characters) for users of earlier versions of Windows.\",\n        \"MaxLength\" : \"15\",\n        \"MinLength\" : \"1\",\n        \"Type\" : \"String\"\n      },\n      \"DomainMemberSecurityGroup\" : {\n        \"Type\" : \"AWS::EC2::SecurityGroup::Id\",\n        \"Description\" : \"Choose the EC2 security group that allows for Active Directory communication.\"\n      },\n      \"ECSImage\" : {\n        \"AllowedPattern\" : \"^[\\\\w\\\\-\\\\:\\\\.\\\\#\\\\/]*$\",\n        \"Default\" : \"microsoft/iis\",\n        \"Description\" : \"ECS Container Image for Windows. Only needed if ECS deployment type is used\",\n        \"MaxLength\" : \"255\",\n        \"MinLength\" : \"2\",\n        \"Type\" : \"String\"\n      },\n      \"ELBSchemeParameter\" : {\n        \"Type\" : \"String\",\n        \"Default\" : \"internet-facing\",\n        \"AllowedValues\" : [ \"internet-facing\", \"internal\" ],\n        \"Description\" : \"Choose whether the Elastic Load Balancer is public or private.\"\n      },\n      \"ELBSubnet1ID\" : {\n        \"Description\" : \"ID of subnet 1 in Availability Zone 1 where the Application Load Balancer will reside (e.g., subnet-a0246dcd). If the Elastic Load Balancer faces the internet, choose a public subnet. Otherwise, choose a private subnet.\",\n        \"Type\" : \"AWS::EC2::Subnet::Id\"\n      },\n      \"ELBSubnet2ID\" : {\n        \"Description\" : \"ID of subnet 2 in Availability Zone 2 where the Application Load Balancer will reside (e.g., subnet-a0246dcd). If the Elastic Load Balancer faces the internet, choose a public subnet. Otherwise, choose a private subnet.\",\n        \"Type\" : \"AWS::EC2::Subnet::Id\"\n      },\n      \"IISServerInstanceType\" : {\n        \"AllowedValues\" : [ \"t2.micro\", \"t2.small\", \"t2.medium\", \"t2.large\", \"t2.xlarge\", \"t2.2xlarge\", \"t3.micro\", \"t3.small\", \"t3.medium\", \"t3.large\", \"t3.xlarge\", \"t3.2xlarge\", \"m4.large\", \"m4.xlarge\", \"m4.2xlarge\", \"m4.4xlarge\", \"m4.10xlarge\", \"m5.large\", \"m5.xlarge\", \"m5.2xlarge\", \"m5.4xlarge\", \"m5.8xlarge\", \"m5.12xlarge\", \"m5.16xlarge\", \"m5.24xlarge\", \"c4.large\", \"c4.xlarge\", \"c4.2xlarge\", \"c4.4xlarge\", \"c4.8xlarge\", \"c5.large\", \"c5.xlarge\", \"c5.2xlarge\", \"c5.4xlarge\", \"c5.9xlarge\", \"c5.12xlarge\", \"c5.18xlarge\", \"c5.24xlarge\", \"r4.large\", \"r4.xlarge\", \"r4.2xlarge\", \"r4.4xlarge\", \"r4.8xlarge\", \"r5.large\", \"r5.xlarge\", \"r5.2xlarge\", \"r5.4xlarge\", \"r5.8xlarge\", \"r5.12xlarge\", \"r5.16xlarge\", \"r5.24xlarge\" ],\n        \"Default\" : \"t3.2xlarge\",\n        \"Description\" : \"Amazon EC2 instance type for the IIS Server instances.\",\n        \"Type\" : \"String\"\n      },\n      \"PrivateSubnet1ID\" : {\n        \"Description\" : \"ID of private subnet 1 in Availability Zone 1 for the EC2 target group (e.g., subnet-a0246dcd).\",\n        \"Type\" : \"AWS::EC2::Subnet::Id\"\n      },\n      \"PrivateSubnet2ID\" : {\n        \"Description\" : \"ID of private subnet 2 in Availability Zone 2 for the EC2 target group (e.g., subnet-a0246dcd).\",\n        \"Type\" : \"AWS::EC2::Subnet::Id\"\n      },\n      \"QSS3BucketName\" : {\n        \"AllowedPattern\" : \"^[a-z0-9]+[a-z0-9\\\\.\\\\-]*[a-z0-9]+$\",\n        \"ConstraintDescription\" : \"Can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).\",\n        \"Default\" : \"aws-quickstart\",\n        \"Description\" : \"S3 bucket name for the Quick Start assets. This name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).\",\n        \"Type\" : \"String\"\n      },\n      \"QSS3KeyPrefix\" : {\n        \"AllowedPattern\" : \"^[a-zA-Z0-9\\\\-\\\\/]+$\",\n        \"ConstraintDescription\" : \"Can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slashes (/).\",\n        \"Default\" : \"quickstart-microsoft-iis/\",\n        \"Description\" : \"S3 key prefix for the Quick Start assets. This prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slashes (/).\",\n        \"Type\" : \"String\"\n      },\n      \"SetupAppInsightsMonitoring\" : {\n        \"AllowedValues\" : [ \"true\", \"false\" ],\n        \"ConstraintDescription\" : \"Can include either true or false.\",\n        \"Default\" : \"false\",\n        \"Description\" : \"Setup Application Insights monitoring for all IIS resources. This parameter can include either true or false.\",\n        \"Type\" : \"String\"\n      },\n      \"WebAccessCIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Description\" : \"The CIDR IP range that is permitted to access the Elastic Load Balancers.\",\n        \"Type\" : \"String\"\n      },\n      \"WebBucketName\" : {\n        \"AllowedPattern\" : \"^([a-z0-9]+[a-z0-9\\\\.\\\\-]*[a-z0-9]+)?$\",\n        \"Type\" : \"String\",\n        \"Description\" : \"Bucket name where html file is located for iis. If left blank, a sample page will be used.\",\n        \"Default\" : \"\"\n      },\n      \"WebBucketKey\" : {\n        \"AllowedPattern\" : \"^[0-9a-zA-Z\\\\-\\\\/\\\\.]+$\",\n        \"ConstraintDescription\" : \"Can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slashes (/).\",\n        \"Description\" : \"Bucket Key where html file is located for iis. Only change S3 Bucket Wepage is specified, otherwise leave as default.\",\n        \"Default\" : \"webfiles/index.html\",\n        \"Type\" : \"String\"\n      },\n      \"VPCID\" : {\n        \"Description\" : \"ID of the VPC (e.g., vpc-0343606e).\",\n        \"Type\" : \"AWS::EC2::VPC::Id\"\n      }\n    },\n    \"Conditions\" : {\n      \"UseDefault\" : {\n        \"Fn::Equals\" : [ {\n          \"Ref\" : \"WebBucketName\"\n        }, \"\" ]\n      },\n      \"ECSDeploy\" : {\n        \"Fn::Equals\" : [ {\n          \"Ref\" : \"DeploymentType\"\n        }, \"ECS\" ]\n      },\n      \"EC2Deploy\" : {\n        \"Fn::Equals\" : [ {\n          \"Ref\" : \"DeploymentType\"\n        }, \"EC2\" ]\n      },\n      \"appInsightsMonitoring\" : {\n        \"Fn::Equals\" : [ {\n          \"Ref\" : \"SetupAppInsightsMonitoring\"\n        }, true ]\n      },\n      \"UsingDefaultAppName\" : {\n        \"Fn::Equals\" : [ {\n          \"Ref\" : \"AppInsightsApplicationName\"\n        }, \"\" ]\n      }\n    },\n    \"Resources\" : {\n      \"ConfigBucket\" : {\n        \"Type\" : \"AWS::S3::Bucket\",\n        \"Properties\" : {\n          \"BucketEncryption\" : {\n            \"ServerSideEncryptionConfiguration\" : [ {\n              \"ServerSideEncryptionByDefault\" : {\n                \"SSEAlgorithm\" : \"AES256\"\n              }\n            } ]\n          },\n          \"LifecycleConfiguration\" : {\n            \"Rules\" : [ {\n              \"Id\" : \"DeleteAfter30Days\",\n              \"ExpirationInDays\" : 30,\n              \"Status\" : \"Enabled\",\n              \"Prefix\" : \"logs/\"\n            } ]\n          }\n        }\n      },\n      \"ConfigBucketPolicy\" : {\n        \"Type\" : \"AWS::S3::BucketPolicy\",\n        \"Properties\" : {\n          \"Bucket\" : {\n            \"Ref\" : \"ConfigBucket\"\n          },\n          \"PolicyDocument\" : {\n            \"Version\" : \"2012-10-17\",\n            \"Statement\" : [ {\n              \"Action\" : \"s3:*\",\n              \"Condition\" : {\n                \"Bool\" : {\n                  \"aws:SecureTransport\" : \"false\"\n                }\n              },\n              \"Effect\" : \"Deny\",\n              \"Principal\" : \"*\",\n              \"Resource\" : [ {\n                \"Fn::Sub\" : \"arn:${AWS::Partition}:s3:::${ConfigBucket}/*\"\n              }, {\n                \"Fn::Sub\" : \"arn:${AWS::Partition}:s3:::${ConfigBucket}\"\n              } ],\n              \"Sid\" : \"SecureTransport\"\n            } ]\n          }\n        }\n      },\n      \"DomainJoinSecrets\" : {\n        \"Type\" : \"AWS::SecretsManager::Secret\",\n        \"Properties\" : {\n          \"Name\" : {\n            \"Fn::Sub\" : \"DomainJoinSecrets-${AWS::StackName}\"\n          },\n          \"Description\" : \"Secrets to join AD domain\",\n          \"SecretString\" : {\n            \"Fn::Sub\" : \"{\\\"username\\\":\\\"${DomainNetBIOSName}\\\\\\\\${DomainAdminUser}\\\",\\\"password\\\":\\\"${DomainAdminPassword}\\\"}\"\n          }\n        }\n      },\n      \"SecurityStack\" : {\n        \"Type\" : \"AWS::CloudFormation::Stack\",\n        \"Properties\" : {\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : \"https://${QSS3BucketName}.s3.${AWS::URLSuffix}/${QSS3KeyPrefix}templates/security.template.yaml\"\n          },\n          \"Parameters\" : {\n            \"ConfigBucket\" : {\n              \"Ref\" : \"ConfigBucket\"\n            },\n            \"DomainJoinSecrets\" : {\n              \"Ref\" : \"DomainJoinSecrets\"\n            },\n            \"ECSClusterName\" : {\n              \"Fn::If\" : [ \"ECSDeploy\", {\n                \"Fn::Sub\" : \"ECSCluster-${AWS::StackName}\"\n              }, \"\" ]\n            },\n            \"RemoveConfigurationDocName\" : {\n              \"Fn::Sub\" : \"RemoveConfigurationDocName-${AWS::StackName}\"\n            },\n            \"SetupConfigurationDocName\" : {\n              \"Fn::Sub\" : \"SetupConfiguration-${AWS::StackName}\"\n            },\n            \"VPCID\" : {\n              \"Ref\" : \"VPCID\"\n            },\n            \"WebAccessCIDR\" : {\n              \"Ref\" : \"WebAccessCIDR\"\n            },\n            \"WebBucketKey\" : {\n              \"Ref\" : \"WebBucketKey\"\n            },\n            \"WebBucketName\" : {\n              \"Fn::If\" : [ \"UseDefault\", {\n                \"Ref\" : \"ConfigBucket\"\n              }, {\n                \"Ref\" : \"WebBucketName\"\n              } ]\n            }\n          }\n        }\n      },\n      \"AutomationStack\" : {\n        \"Type\" : \"AWS::CloudFormation::Stack\",\n        \"Properties\" : {\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : \"https://${QSS3BucketName}.s3.${AWS::URLSuffix}/${QSS3KeyPrefix}templates/automation-parts.template.yaml\"\n          },\n          \"Parameters\" : {\n            \"ConfigBucket\" : {\n              \"Ref\" : \"ConfigBucket\"\n            },\n            \"DomainJoinSecrets\" : {\n              \"Ref\" : \"DomainJoinSecrets\"\n            },\n            \"ECSClusterName\" : {\n              \"Fn::If\" : [ \"ECSDeploy\", {\n                \"Fn::Sub\" : \"ECSCluster-${AWS::StackName}\"\n              }, \"\" ]\n            },\n            \"RemoveConfigurationDocName\" : {\n              \"Fn::Sub\" : \"RemoveConfigurationDocName-${AWS::StackName}\"\n            },\n            \"SetupConfigurationDocName\" : {\n              \"Fn::Sub\" : \"SetupConfiguration-${AWS::StackName}\"\n            },\n            \"WebBucketKey\" : {\n              \"Ref\" : \"WebBucketKey\"\n            },\n            \"WebBucketName\" : {\n              \"Fn::If\" : [ \"UseDefault\", {\n                \"Ref\" : \"ConfigBucket\"\n              }, {\n                \"Ref\" : \"WebBucketName\"\n              } ]\n            },\n            \"WriteS3LambdaRoleArn\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.WriteS3LambdaRoleArn\" ]\n            }\n          }\n        }\n      },\n      \"EC2WebAutoScaleStack\" : {\n        \"Condition\" : \"EC2Deploy\",\n        \"Type\" : \"AWS::CloudFormation::Stack\",\n        \"Properties\" : {\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : \"https://${QSS3BucketName}.s3.${AWS::URLSuffix}/${QSS3KeyPrefix}templates/ec2-asg-lch.template.yaml\"\n          },\n          \"Parameters\" : {\n            \"ALBListenersSecurityGroup\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ALBListenersSecurityGroup\" ]\n            },\n            \"ALBSecurityGroup\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ALBSecurityGroup\" ]\n            },\n            \"ASGDesiredCapacity\" : {\n              \"Ref\" : \"ASGDesiredCapacity\"\n            },\n            \"ASGMaxSize\" : {\n              \"Ref\" : \"ASGMaxSize\"\n            },\n            \"ASGMinSize\" : {\n              \"Ref\" : \"ASGMinSize\"\n            },\n            \"AutoScalingGroupName\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.AutoScalingGroupName\" ]\n            },\n            \"ConfigBucket\" : {\n              \"Ref\" : \"ConfigBucket\"\n            },\n            \"DomainDNSName\" : {\n              \"Ref\" : \"DomainDNSName\"\n            },\n            \"DomainMemberSecurityGroup\" : {\n              \"Ref\" : \"DomainMemberSecurityGroup\"\n            },\n            \"ELBSchemeParameter\" : {\n              \"Ref\" : \"ELBSchemeParameter\"\n            },\n            \"ELBSubnet1ID\" : {\n              \"Ref\" : \"ELBSubnet1ID\"\n            },\n            \"ELBSubnet2ID\" : {\n              \"Ref\" : \"ELBSubnet2ID\"\n            },\n            \"EventBridgeSSMAutoRole\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.EventBridgeSSMAutoRole\" ]\n            },\n            \"ExecutionResourceArn\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ExecutionResourceArn\" ]\n            },\n            \"IISServerInstanceType\" : {\n              \"Ref\" : \"IISServerInstanceType\"\n            },\n            \"RemoveConfigurationDocName\" : {\n              \"Fn::GetAtt\" : [ \"AutomationStack\", \"Outputs.RemoveConfigurationDocName\" ]\n            },\n            \"SSMInstanceProfileName\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.SSMInstanceProfileName\" ]\n            },\n            \"SetupConfigurationDocName\" : {\n              \"Fn::GetAtt\" : [ \"AutomationStack\", \"Outputs.SetupConfigurationDocName\" ]\n            },\n            \"VPCID\" : {\n              \"Ref\" : \"VPCID\"\n            },\n            \"WorkloadSubnet1ID\" : {\n              \"Ref\" : \"PrivateSubnet1ID\"\n            },\n            \"WorkloadSubnet2ID\" : {\n              \"Ref\" : \"PrivateSubnet2ID\"\n            }\n          }\n        }\n      },\n      \"ECSWinNodesStack\" : {\n        \"Condition\" : \"ECSDeploy\",\n        \"Type\" : \"AWS::CloudFormation::Stack\",\n        \"Properties\" : {\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : \"https://${QSS3BucketName}.s3.${AWS::URLSuffix}/${QSS3KeyPrefix}templates/ecs-asg-lch.template.yaml\"\n          },\n          \"Parameters\" : {\n            \"ALBListenersSecurityGroup\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ALBListenersSecurityGroup\" ]\n            },\n            \"ALBSecurityGroup\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ALBSecurityGroup\" ]\n            },\n            \"ASGDesiredCapacity\" : {\n              \"Ref\" : \"ASGDesiredCapacity\"\n            },\n            \"ASGMaxSize\" : {\n              \"Ref\" : \"ASGMaxSize\"\n            },\n            \"ASGMinSize\" : {\n              \"Ref\" : \"ASGMinSize\"\n            },\n            \"AutoScalingGroupName\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.AutoScalingGroupName\" ]\n            },\n            \"AutoscalingRole\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.AutoscalingRole\" ]\n            },\n            \"ConfigBucket\" : {\n              \"Ref\" : \"ConfigBucket\"\n            },\n            \"DomainDNSName\" : {\n              \"Ref\" : \"DomainDNSName\"\n            },\n            \"DomainMemberSecurityGroup\" : {\n              \"Ref\" : \"DomainMemberSecurityGroup\"\n            },\n            \"ECSClusterName\" : {\n              \"Fn::Sub\" : \"ECSCluster-${AWS::StackName}\"\n            },\n            \"ECSServiceRole\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ECSServiceRole\" ]\n            },\n            \"ECSImage\" : {\n              \"Ref\" : \"ECSImage\"\n            },\n            \"ECSTaskRole\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ECSTaskRole\" ]\n            },\n            \"ELBSchemeParameter\" : {\n              \"Ref\" : \"ELBSchemeParameter\"\n            },\n            \"ELBSubnet1ID\" : {\n              \"Ref\" : \"ELBSubnet1ID\"\n            },\n            \"ELBSubnet2ID\" : {\n              \"Ref\" : \"ELBSubnet2ID\"\n            },\n            \"EventBridgeSSMAutoRole\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.EventBridgeSSMAutoRole\" ]\n            },\n            \"ExecutionResourceArn\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.ExecutionResourceArn\" ]\n            },\n            \"IISServerInstanceType\" : {\n              \"Ref\" : \"IISServerInstanceType\"\n            },\n            \"RemoveConfigurationDocName\" : {\n              \"Fn::GetAtt\" : [ \"AutomationStack\", \"Outputs.RemoveConfigurationDocName\" ]\n            },\n            \"SSMInstanceProfileName\" : {\n              \"Fn::GetAtt\" : [ \"SecurityStack\", \"Outputs.SSMInstanceProfileName\" ]\n            },\n            \"SetupConfigurationDocName\" : {\n              \"Fn::GetAtt\" : [ \"AutomationStack\", \"Outputs.SetupConfigurationDocName\" ]\n            },\n            \"VPCID\" : {\n              \"Ref\" : \"VPCID\"\n            },\n            \"WorkloadSubnet1ID\" : {\n              \"Ref\" : \"PrivateSubnet1ID\"\n            },\n            \"WorkloadSubnet2ID\" : {\n              \"Ref\" : \"PrivateSubnet2ID\"\n            }\n          }\n        }\n      },\n      \"IISResourceGroup\" : {\n        \"Condition\" : \"appInsightsMonitoring\",\n        \"Type\" : \"AWS::ResourceGroups::Group\",\n        \"Properties\" : {\n          \"Name\" : {\n            \"Fn::If\" : [ \"UsingDefaultAppName\", {\n              \"Fn::Sub\" : \"ApplicationInsights-${AWS::StackName}\"\n            }, {\n              \"Ref\" : \"AppInsightsApplicationName\"\n            } ]\n          },\n          \"ResourceQuery\" : {\n            \"Query\" : {\n              \"TagFilters\" : [ {\n                \"Key\" : \"aws:cloudformation:stack-name\",\n                \"Values\" : {\n                  \"Fn::If\" : [ \"ECSDeploy\", [ {\n                    \"Fn::GetAtt\" : [ \"ECSWinNodesStack\", \"Outputs.ECSASGStackName\" ]\n                  }, {\n                    \"Fn::Sub\" : \"${AWS::StackName}\"\n                  } ], [ {\n                    \"Fn::GetAtt\" : [ \"EC2WebAutoScaleStack\", \"Outputs.EC2ASGStackName\" ]\n                  }, {\n                    \"Fn::Sub\" : \"${AWS::StackName}\"\n                  } ] ]\n                }\n              } ]\n            },\n            \"Type\" : \"TAG_FILTERS_1_0\"\n          }\n        }\n      },\n      \"ApplicationInsightsIIS\" : {\n        \"Condition\" : \"appInsightsMonitoring\",\n        \"Type\" : \"AWS::ApplicationInsights::Application\",\n        \"Properties\" : {\n          \"ResourceGroupName\" : {\n            \"Ref\" : \"IISResourceGroup\"\n          },\n          \"AutoConfigurationEnabled\" : true\n        },\n        \"DependsOn\" : \"IISResourceGroup\"\n      }\n    },\n    \"Outputs\" : {\n      \"ConfigBucket\" : {\n        \"Value\" : {\n          \"Ref\" : \"ConfigBucket\"\n        }\n      },\n      \"DomainJoinSecrets\" : {\n        \"Value\" : {\n          \"Ref\" : \"DomainJoinSecrets\"\n        }\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-11-28T21:32:22.284Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "CloudFormation"
  },
  "DocumentVersion": "10",
  "Name": "AWSQuickStarts-Microsoft-IIS-Existing-VPC",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": "AWSQuickStarts-Microsoft-IIS-Existing-VPC-2022-11-28-21-29-45",
  "ResponseMetadata": {
    "RequestId": "21eca5df-2616-4375-ac08-9eb794b9d3e9",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 28002,
  "HttpStatusCode": 200,
  "LoggedAt": "2022-12-12T07:12:39.6242391+00:00"
}
