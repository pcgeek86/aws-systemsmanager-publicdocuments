{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for EC2\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"CloudwatchAlarmResourceCheckParamMetricName\" : {\n        \"Default\" : \"CPUUtilization\",\n        \"Type\" : \"String\"\n      },\n      \"CloudwatchAlarmResourceCheckParamResourceType\" : {\n        \"Default\" : \"AWS::EC2::Instance\",\n        \"Type\" : \"String\"\n      },\n      \"Ec2VolumeInuseCheckParamDeleteOnTermination\" : {\n        \"Default\" : \"TRUE\",\n        \"Type\" : \"String\"\n      },\n      \"ServiceVpcEndpointEnabledParamServiceName\" : {\n        \"Default\" : \"ec2\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"CloudwatchAlarmResourceCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudwatch-alarm-resource-check\",\n          \"InputParameters\" : {\n            \"metricName\" : {\n              \"Fn::If\" : [ \"cloudwatchAlarmResourceCheckParamMetricName\", {\n                \"Ref\" : \"CloudwatchAlarmResourceCheckParamMetricName\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"resourceType\" : {\n              \"Fn::If\" : [ \"cloudwatchAlarmResourceCheckParamResourceType\", {\n                \"Ref\" : \"CloudwatchAlarmResourceCheckParamResourceType\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDWATCH_ALARM_RESOURCE_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EbsOptimizedInstance\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ebs-optimized-instance\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EBS_OPTIMIZED_INSTANCE\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2EbsEncryptionByDefault\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-ebs-encryption-by-default\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_EBS_ENCRYPTION_BY_DEFAULT\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2Imdsv2Check\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-imdsv2-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_IMDSV2_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceDetailedMonitoringEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-detailed-monitoring-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_DETAILED_MONITORING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceManagedBySsm\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-managed-by-systems-manager\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\", \"AWS::SSM::ManagedInstanceInventory\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_MANAGED_BY_SSM\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceMultipleEniCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-multiple-eni-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_MULTIPLE_ENI_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceNoPublicIp\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-no-public-ip\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_NO_PUBLIC_IP\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceProfileAttached\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-profile-attached\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_PROFILE_ATTACHED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2ManagedinstanceAssociationComplianceStatusCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-managedinstance-association-compliance-status-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SSM::AssociationCompliance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_MANAGEDINSTANCE_ASSOCIATION_COMPLIANCE_STATUS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2ManagedinstancePatchComplianceStatusCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-managedinstance-patch-compliance-status-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SSM::PatchCompliance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_MANAGEDINSTANCE_PATCH_COMPLIANCE_STATUS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2NoAmazonKeyPair\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-no-amazon-key-pair\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_NO_AMAZON_KEY_PAIR\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2ResourcesProtectedByBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-resources-protected-by-backup-plan\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_RESOURCES_PROTECTED_BY_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2StoppedInstance\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-stopped-instance\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_STOPPED_INSTANCE\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2TokenHopLimitCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-token-hop-limit-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_TOKEN_HOP_LIMIT_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2VolumeInuseCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-volume-inuse-check\",\n          \"InputParameters\" : {\n            \"deleteOnTermination\" : {\n              \"Fn::If\" : [ \"ec2VolumeInuseCheckParamDeleteOnTermination\", {\n                \"Ref\" : \"Ec2VolumeInuseCheckParamDeleteOnTermination\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Volume\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_VOLUME_INUSE_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EipAttached\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"eip-attached\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::EIP\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EIP_ATTACHED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IncomingSshDisabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"restricted-ssh\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::SecurityGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"INCOMING_SSH_DISABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"InstancesInVpc\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instances-in-vpc\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"INSTANCES_IN_VPC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ServiceVpcEndpointEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"service-vpc-endpoint-enabled\",\n          \"InputParameters\" : {\n            \"serviceName\" : {\n              \"Fn::If\" : [ \"serviceVpcEndpointEnabledParamServiceName\", {\n                \"Ref\" : \"ServiceVpcEndpointEnabledParamServiceName\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SERVICE_VPC_ENDPOINT_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    },\n    \"Conditions\" : {\n      \"cloudwatchAlarmResourceCheckParamMetricName\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"CloudwatchAlarmResourceCheckParamMetricName\"\n          } ]\n        } ]\n      },\n      \"cloudwatchAlarmResourceCheckParamResourceType\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"CloudwatchAlarmResourceCheckParamResourceType\"\n          } ]\n        } ]\n      },\n      \"ec2VolumeInuseCheckParamDeleteOnTermination\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"Ec2VolumeInuseCheckParamDeleteOnTermination\"\n          } ]\n        } ]\n      },\n      \"serviceVpcEndpointEnabledParamServiceName\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"ServiceVpcEndpointEnabledParamServiceName\"\n          } ]\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:48:19.433Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforEC2",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "03fb3877-bf47-4692-b125-7efa7b037351",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 11957,
  "HttpStatusCode": 200,
  "LoggedAt": "2023-05-15T07:11:44.7829095+00:00"
}
