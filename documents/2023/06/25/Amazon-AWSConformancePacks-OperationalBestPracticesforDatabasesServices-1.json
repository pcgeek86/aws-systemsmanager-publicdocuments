{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for Database Services\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"DynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\" : {\n        \"Default\" : \"80\",\n        \"Type\" : \"String\"\n      },\n      \"DynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\" : {\n        \"Default\" : \"80\",\n        \"Type\" : \"String\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\" : {\n        \"Default\" : \"TRUE\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"AuroraResourcesProtectedByBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"aurora-resources-protected-by-backup-plan\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBCluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AURORA_RESOURCES_PROTECTED_BY_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DbInstanceBackupEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"db-instance-backup-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DB_INSTANCE_BACKUP_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DmsReplicationNotPublic\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dms-replication-not-public\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DMS_REPLICATION_NOT_PUBLIC\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbAutoscalingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-autoscaling-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::DynamoDB::Table\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_AUTOSCALING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbInBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-in-backup-plan\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_IN_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbPitrEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-pitr-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::DynamoDB::Table\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_PITR_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbTableEncryptedKms\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-table-encrypted-kms\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::DynamoDB::Table\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_TABLE_ENCRYPTED_KMS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbThroughputLimitCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-throughput-limit-check\",\n          \"InputParameters\" : {\n            \"accountRCUThresholdPercentage\" : {\n              \"Fn::If\" : [ \"dynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\", {\n                \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"accountWCUThresholdPercentage\" : {\n              \"Fn::If\" : [ \"dynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\", {\n                \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_THROUGHPUT_LIMIT_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsAutomaticMinorVersionUpgradeEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-automatic-minor-version-upgrade-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_AUTOMATIC_MINOR_VERSION_UPGRADE_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsEnhancedMonitoringEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-enhanced-monitoring-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_ENHANCED_MONITORING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInBackupPlan\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-in-backup-plan\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_IN_BACKUP_PLAN\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInstanceDefaultAdminCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-instance-default-admin-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_INSTANCE_DEFAULT_ADMIN_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInstanceDeletionProtectionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-instance-deletion-protection-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_INSTANCE_DELETION_PROTECTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsInstancePublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-instance-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_INSTANCE_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsLoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-logging-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsMultiAzSupport\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-multi-az-support\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_MULTI_AZ_SUPPORT\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsSnapshotEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-snapshot-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBSnapshot\", \"AWS::RDS::DBClusterSnapshot\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_SNAPSHOT_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsSnapshotsPublicProhibited\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-snapshots-public-prohibited\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBSnapshot\", \"AWS::RDS::DBClusterSnapshot\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_SNAPSHOTS_PUBLIC_PROHIBITED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsStorageEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-storage-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_STORAGE_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftAuditLoggingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-audit-logging-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_AUDIT_LOGGING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftBackupEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-backup-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_BACKUP_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterConfigurationCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-configuration-check\",\n          \"InputParameters\" : {\n            \"clusterDbEncrypted\" : \"TRUE\",\n            \"loggingEnabled\" : \"TRUE\"\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_CONFIGURATION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterKmsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-kms-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_KMS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterMaintenancesettingsCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-maintenancesettings-check\",\n          \"InputParameters\" : {\n            \"allowVersionUpgrade\" : {\n              \"Fn::If\" : [ \"redshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\", {\n                \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_MAINTENANCESETTINGS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterPublicAccessCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-public-access-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_PUBLIC_ACCESS_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftDefaultAdminCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-default-admin-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_DEFAULT_ADMIN_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftDefaultDbNameCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-default-db-name-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_DEFAULT_DB_NAME_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftEnhancedVpcRoutingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-enhanced-vpc-routing-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_ENHANCED_VPC_ROUTING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftRequireTlsSsl\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-require-tls-ssl\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_REQUIRE_TLS_SSL\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    },\n    \"Conditions\" : {\n      \"dynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\"\n          } ]\n        } ]\n      },\n      \"dynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\"\n          } ]\n        } ]\n      },\n      \"redshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"RedshiftClusterMaintenancesettingsCheckParamAllowVersionUpgrade\"\n          } ]\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:47:55.431Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforDatabasesServices",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "ac11c715-941e-4383-b635-f4495dcee557",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 16093,
  "HttpStatusCode": 200,
  "LoggedAt": "2023-06-25T07:12:00.9101832+00:00"
}
