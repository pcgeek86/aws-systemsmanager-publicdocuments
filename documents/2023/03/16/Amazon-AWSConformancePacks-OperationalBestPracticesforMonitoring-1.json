{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for Monitoring\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"DynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\" : {\n        \"Default\" : \"80\",\n        \"Type\" : \"String\"\n      },\n      \"DynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\" : {\n        \"Default\" : \"80\",\n        \"Type\" : \"String\"\n      },\n      \"GuarddutyNonArchivedFindingsParamDaysHighSev\" : {\n        \"Default\" : \"1\",\n        \"Type\" : \"String\"\n      },\n      \"GuarddutyNonArchivedFindingsParamDaysLowSev\" : {\n        \"Default\" : \"30\",\n        \"Type\" : \"String\"\n      },\n      \"GuarddutyNonArchivedFindingsParamDaysMediumSev\" : {\n        \"Default\" : \"7\",\n        \"Type\" : \"String\"\n      },\n      \"LambdaConcurrencyCheckParamConcurrencyLimitHigh\" : {\n        \"Default\" : \"1000\",\n        \"Type\" : \"String\"\n      },\n      \"LambdaConcurrencyCheckParamConcurrencyLimitLow\" : {\n        \"Default\" : \"500\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"ApiGwXrayEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-xray-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_XRAY_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AutoscalingGroupElbHealthcheckRequired\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"autoscaling-group-elb-healthcheck-required\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::AutoScaling::AutoScalingGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"AUTOSCALING_GROUP_ELB_HEALTHCHECK_REQUIRED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"BeanstalkEnhancedHealthReportingEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"beanstalk-enhanced-health-reporting-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticBeanstalk::Environment\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"BEANSTALK_ENHANCED_HEALTH_REPORTING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudTrailCloudWatchLogsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloud-trail-cloud-watch-logs-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUD_TRAIL_CLOUD_WATCH_LOGS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudwatchAlarmActionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudwatch-alarm-action-check\",\n          \"InputParameters\" : {\n            \"alarmActionRequired\" : \"TRUE\",\n            \"insufficientDataActionRequired\" : \"TRUE\",\n            \"okActionRequired\" : \"FALSE\"\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CloudWatch::Alarm\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDWATCH_ALARM_ACTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudwatchAlarmActionEnabledCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudwatch-alarm-action-enabled-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CloudWatch::Alarm\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDWATCH_ALARM_ACTION_ENABLED_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CodedeployAutoRollbackMonitorEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"codedeploy-auto-rollback-monitor-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CodeDeploy::DeploymentGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CODEDEPLOY_AUTO_ROLLBACK_MONITOR_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CodedeployEc2MinimumHealthyHostsConfigured\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"codedeploy-ec2-minimum-healthy-hosts-configured\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::CodeDeploy::DeploymentGroup\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CODEDEPLOY_EC2_MINIMUM_HEALTHY_HOSTS_CONFIGURED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbThroughputLimitCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-throughput-limit-check\",\n          \"InputParameters\" : {\n            \"accountRCUThresholdPercentage\" : {\n              \"Fn::If\" : [ \"dynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\", {\n                \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"accountWCUThresholdPercentage\" : {\n              \"Fn::If\" : [ \"dynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\", {\n                \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_THROUGHPUT_LIMIT_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2InstanceDetailedMonitoringEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-instance-detailed-monitoring-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Instance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_INSTANCE_DETAILED_MONITORING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EcsContainerInsightsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ecs-container-insights-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ECS::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ECS_CONTAINER_INSIGHTS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"GuarddutyEnabledCentralized\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"guardduty-enabled-centralized\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"GUARDDUTY_ENABLED_CENTRALIZED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"GuarddutyNonArchivedFindings\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"guardduty-non-archived-findings\",\n          \"InputParameters\" : {\n            \"daysHighSev\" : {\n              \"Fn::If\" : [ \"guarddutyNonArchivedFindingsParamDaysHighSev\", {\n                \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysHighSev\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"daysLowSev\" : {\n              \"Fn::If\" : [ \"guarddutyNonArchivedFindingsParamDaysLowSev\", {\n                \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysLowSev\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"daysMediumSev\" : {\n              \"Fn::If\" : [ \"guarddutyNonArchivedFindingsParamDaysMediumSev\", {\n                \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysMediumSev\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"GUARDDUTY_NON_ARCHIVED_FINDINGS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaConcurrencyCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-concurrency-check\",\n          \"InputParameters\" : {\n            \"ConcurrencyLimitHigh\" : {\n              \"Fn::If\" : [ \"lambdaConcurrencyCheckParamConcurrencyLimitHigh\", {\n                \"Ref\" : \"LambdaConcurrencyCheckParamConcurrencyLimitHigh\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            },\n            \"ConcurrencyLimitLow\" : {\n              \"Fn::If\" : [ \"lambdaConcurrencyCheckParamConcurrencyLimitLow\", {\n                \"Ref\" : \"LambdaConcurrencyCheckParamConcurrencyLimitLow\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_CONCURRENCY_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"LambdaDlqCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"lambda-dlq-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Lambda::Function\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"LAMBDA_DLQ_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsEnhancedMonitoringEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-enhanced-monitoring-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_ENHANCED_MONITORING_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3EventNotificationsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-event-notifications-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_EVENT_NOTIFICATIONS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SecurityhubEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"securityhub-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SECURITYHUB_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    },\n    \"Conditions\" : {\n      \"dynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountRCUThresholdPercentage\"\n          } ]\n        } ]\n      },\n      \"dynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"DynamodbThroughputLimitCheckParamAccountWCUThresholdPercentage\"\n          } ]\n        } ]\n      },\n      \"guarddutyNonArchivedFindingsParamDaysHighSev\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysHighSev\"\n          } ]\n        } ]\n      },\n      \"guarddutyNonArchivedFindingsParamDaysLowSev\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysLowSev\"\n          } ]\n        } ]\n      },\n      \"guarddutyNonArchivedFindingsParamDaysMediumSev\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"GuarddutyNonArchivedFindingsParamDaysMediumSev\"\n          } ]\n        } ]\n      },\n      \"lambdaConcurrencyCheckParamConcurrencyLimitHigh\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"LambdaConcurrencyCheckParamConcurrencyLimitHigh\"\n          } ]\n        } ]\n      },\n      \"lambdaConcurrencyCheckParamConcurrencyLimitLow\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"LambdaConcurrencyCheckParamConcurrencyLimitLow\"\n          } ]\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:50:27.433Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforMonitoring",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "037ff2f3-2f5d-41af-a235-8e692c74fa97",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 13598,
  "HttpStatusCode": 200,
  "LoggedAt": "2023-03-16T07:12:21.2443408+00:00"
}
