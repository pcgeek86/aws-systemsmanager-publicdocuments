{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"HashiCorp Vault, License: Apache 2.0 (Please do not remove) Oct,18,2019\",\n  \"templateBody\" : {\n    \"AWSTemplateFormatVersion\" : \"2010-09-09\",\n    \"Description\" : \"HashiCorp Vault, License: Apache 2.0 (Please do not remove) Oct,18,2019\",\n    \"Metadata\" : {\n      \"AWS::CloudFormation::Interface\" : {\n        \"ParameterGroups\" : [ {\n          \"Label\" : {\n            \"default\" : \"VPC network configuration\"\n          },\n          \"Parameters\" : [ \"AvailabilityZones\", \"VPCCIDR\", \"PrivateSubnet1CIDR\", \"PrivateSubnet2CIDR\", \"PrivateSubnet3CIDR\", \"PublicSubnet1CIDR\", \"PublicSubnet2CIDR\", \"PublicSubnet3CIDR\", \"AccessCIDR\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"Bastion configuration\"\n          },\n          \"Parameters\" : [ \"NumBastionHosts\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"HashiCorp Vault configuration\"\n          },\n          \"Parameters\" : [ \"KeyPairName\", \"VaultVersion\", \"VaultAMIOS\", \"VaultServerNodes\", \"VaultInstanceType\", \"VaultNumberOfKeys\", \"VaultNumberOfKeysForUnseal\", \"VaultClientRoleName\", \"VaultClientNodes\", \"VaultKubernetesEnable\", \"VaultKubernetesHostURL\", \"VaultKubernetesRoleName\", \"VaultKubernetesCertificate\", \"VaultKubernetesJWT\", \"VaultKubernetesServiceAccount\", \"VaultKubernetesNameSpace\", \"VaultKubernetesPolicies\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"AWS Quick Start configuration\"\n          },\n          \"Parameters\" : [ \"QSS3BucketName\", \"QSS3KeyPrefix\", \"QSS3BucketRegion\" ]\n        }, {\n          \"Label\" : {\n            \"default\" : \"Load Balancer configuration\"\n          },\n          \"Parameters\" : [ \"LoadBalancerType\", \"DomainName\", \"HostedZoneID\", \"ACMSSLCertificateArn\" ]\n        } ],\n        \"ParameterLabels\" : {\n          \"AvailabilityZones\" : {\n            \"default\" : \"Availability Zones\"\n          },\n          \"KeyPairName\" : {\n            \"default\" : \"EC2 key pair\"\n          },\n          \"NumBastionHosts\" : {\n            \"default\" : \"Bastion hosts\"\n          },\n          \"PrivateSubnet1CIDR\" : {\n            \"default\" : \"Private subnet 1 CIDR\"\n          },\n          \"PrivateSubnet2CIDR\" : {\n            \"default\" : \"Private subnet 2 CIDR\"\n          },\n          \"PrivateSubnet3CIDR\" : {\n            \"default\" : \"Private subnet 3 CIDR\"\n          },\n          \"PublicSubnet1CIDR\" : {\n            \"default\" : \"Public subnet 1 CIDR\"\n          },\n          \"PublicSubnet2CIDR\" : {\n            \"default\" : \"Public subnet 2 CIDR\"\n          },\n          \"PublicSubnet3CIDR\" : {\n            \"default\" : \"Public subnet 3 CIDR\"\n          },\n          \"QSS3BucketName\" : {\n            \"default\" : \"Quick Start S3 bucket name\"\n          },\n          \"QSS3KeyPrefix\" : {\n            \"default\" : \"Quick Start S3 object key prefix\"\n          },\n          \"QSS3BucketRegion\" : {\n            \"default\" : \"Quick Start S3 bucket Region\"\n          },\n          \"AccessCIDR\" : {\n            \"default\" : \"Permitted IP range\"\n          },\n          \"VPCID\" : {\n            \"default\" : \"VPC ID\"\n          },\n          \"VPCCIDR\" : {\n            \"default\" : \"VPC CIDR\"\n          },\n          \"VaultVersion\" : {\n            \"default\" : \"HashiCorp Vault version\"\n          },\n          \"VaultAMIOS\" : {\n            \"default\" : \"Vault cluster operating system\"\n          },\n          \"VaultClientNodes\" : {\n            \"default\" : \"Vault client nodes\"\n          },\n          \"VaultServerNodes\" : {\n            \"default\" : \"Vault server nodes\"\n          },\n          \"VaultInstanceType\" : {\n            \"default\" : \"Instance type\"\n          },\n          \"VaultNumberOfKeys\" : {\n            \"default\" : \"Unseal keys to create\"\n          },\n          \"VaultNumberOfKeysForUnseal\" : {\n            \"default\" : \"Required unseal keys\"\n          },\n          \"VaultClientRoleName\" : {\n            \"default\" : \"Vault AWS role name\"\n          },\n          \"LoadBalancerType\" : {\n            \"default\" : \"Internal/external load balancer\"\n          },\n          \"ACMSSLCertificateArn\" : {\n            \"default\" : \"SSL certificate ARN\"\n          },\n          \"HostedZoneID\" : {\n            \"default\" : \"Hosted-zone ID\"\n          },\n          \"DomainName\" : {\n            \"default\" : \"Load balancer DNS domain name\"\n          },\n          \"VaultKubernetesEnable\" : {\n            \"default\" : \"Enable Kubernetes authentication\"\n          },\n          \"VaultKubernetesRoleName\" : {\n            \"default\" : \"Kubernetes Vault role name\"\n          },\n          \"VaultKubernetesHostURL\" : {\n            \"default\" : \"Kubernetes host URL\"\n          },\n          \"VaultKubernetesCertificate\" : {\n            \"default\" : \"Kubernetes CA certificate\"\n          },\n          \"VaultKubernetesJWT\" : {\n            \"default\" : \"Kubernetes JWT token\"\n          },\n          \"VaultKubernetesServiceAccount\" : {\n            \"default\" : \"Kubernetes service account name\"\n          },\n          \"VaultKubernetesNameSpace\" : {\n            \"default\" : \"Kubernetes name space\"\n          },\n          \"VaultKubernetesPolicies\" : {\n            \"default\" : \"Kubernetes Vault policies\"\n          }\n        }\n      }\n    },\n    \"Conditions\" : {\n      \"UsingDefaultBucket\" : {\n        \"Fn::Equals\" : [ {\n          \"Ref\" : \"QSS3BucketName\"\n        }, \"aws-quickstart\" ]\n      }\n    },\n    \"Parameters\" : {\n      \"AvailabilityZones\" : {\n        \"Description\" : \"List of Availability Zones to use for the VPC subnets. Three Availability Zones are used for this deployment.\",\n        \"Type\" : \"List<AWS::EC2::AvailabilityZone::Name>\"\n      },\n      \"VaultAMIOS\" : {\n        \"AllowedValues\" : [ \"Ubuntu-1604-HVM\", \"Ubuntu-2004-HVM\", \"CIS-Ubuntu-1604-HVM\", \"CIS-Ubuntu-2004-HVM\" ],\n        \"Default\" : \"Ubuntu-2004-HVM\",\n        \"Description\" : \"Linux distribution AMI for the Vault instances.\",\n        \"Type\" : \"String\"\n      },\n      \"KeyPairName\" : {\n        \"Description\" : \"Key pair to securely connect to your instance. after it launches.\",\n        \"Type\" : \"AWS::EC2::KeyPair::KeyName\"\n      },\n      \"NumBastionHosts\" : {\n        \"Description\" : \"Enter the number of bastion hosts to create.\",\n        \"AllowedValues\" : [ 1, 2 ],\n        \"Type\" : \"String\",\n        \"Default\" : 1\n      },\n      \"PrivateSubnet1CIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Default\" : \"10.0.0.0/19\",\n        \"Description\" : \"CIDR block for private subnet 1 located in Availability Zone 1.\",\n        \"Type\" : \"String\"\n      },\n      \"PrivateSubnet2CIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Default\" : \"10.0.32.0/19\",\n        \"Description\" : \"CIDR block for private subnet 2 located in Availability Zone 2.\",\n        \"Type\" : \"String\"\n      },\n      \"PrivateSubnet3CIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Default\" : \"10.0.64.0/19\",\n        \"Description\" : \"CIDR block for private subnet 3 located in Availability Zone 3.\",\n        \"Type\" : \"String\"\n      },\n      \"PublicSubnet1CIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Default\" : \"10.0.128.0/20\",\n        \"Description\" : \"CIDR block for public DMZ subnet 1 located in Availability Zone 1. 1\",\n        \"Type\" : \"String\"\n      },\n      \"PublicSubnet2CIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Default\" : \"10.0.144.0/20\",\n        \"Description\" : \"CIDR block for public DMZ subnet 2 located in Availability Zone 2. 2\",\n        \"Type\" : \"String\"\n      },\n      \"PublicSubnet3CIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Default\" : \"10.0.160.0/20\",\n        \"Description\" : \"CIDR block for public DMZ subnet 3 located in Availability Zone 3. 3\",\n        \"Type\" : \"String\"\n      },\n      \"QSS3BucketName\" : {\n        \"AllowedPattern\" : \"^[0-9a-zA-Z]+([0-9a-zA-Z-]*[0-9a-zA-Z])*$\",\n        \"ConstraintDescription\" : \"Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).\",\n        \"Default\" : \"aws-quickstart\",\n        \"Description\" : \"S3 bucket name for the Quick Start assets. The Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).\",\n        \"Type\" : \"String\"\n      },\n      \"QSS3BucketRegion\" : {\n        \"Default\" : \"us-east-1\",\n        \"Description\" : \"Region where the Quick Start S3 bucket (QSS3BucketName) is hosted. If you use your own bucket, specify the applicable Region.\",\n        \"Type\" : \"String\"\n      },\n      \"QSS3KeyPrefix\" : {\n        \"AllowedPattern\" : \"^[0-9a-zA-Z-/]*$\",\n        \"ConstraintDescription\" : \"Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and a forward slash (/).\",\n        \"Default\" : \"quickstart-hashicorp-vault/\",\n        \"Description\" : \"S3 key prefix for the Quick Start assets. The prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and a forward slash (/).\",\n        \"Type\" : \"String\"\n      },\n      \"VPCCIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"ConstraintDescription\" : \"CIDR block parameter must be in the form x.x.x.x/16-28\",\n        \"Default\" : \"10.0.0.0/16\",\n        \"Description\" : \"CIDR block for the VPC.\",\n        \"Type\" : \"String\"\n      },\n      \"AccessCIDR\" : {\n        \"AllowedPattern\" : \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\\\/([0-9]|[1-2][0-9]|3[0-2]))$\",\n        \"Description\" : \"CIDR IP range permitted to access Vault. A value of 0.0.0.0/0 allows access from any IP address.\",\n        \"Type\" : \"String\"\n      },\n      \"VaultServerNodes\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"Sets DesiredCapacity and MaxSize for the Vault server Auto Scaling group.\",\n        \"AllowedValues\" : [ \"3\", \"5\", \"7\" ],\n        \"Default\" : \"3\"\n      },\n      \"VaultClientNodes\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"Sets DesiredCapacity and MaxSize for the Vault client Auto Scaling group.\",\n        \"AllowedValues\" : [ \"0\", \"1\" ],\n        \"Default\" : \"0\"\n      },\n      \"VaultInstanceType\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"HashiCorp Vault node instance type.\",\n        \"AllowedValues\" : [ \"c5.12xlarge\", \"c5.18xlarge\", \"c5.24xlarge\", \"c5.2xlarge\", \"c5.4xlarge\", \"c5.9xlarge\", \"c5.large\", \"c5.xlarge\", \"m5.12xlarge\", \"m5.16xlarge\", \"m5.24xlarge\", \"m5.2xlarge\", \"m5.4xlarge\", \"m5.8xlarge\", \"m5.large\", \"m5.metal\", \"m5.xlarge\", \"r5.12xlarge\", \"r5.16xlarge\", \"r5.24xlarge\", \"r5.2xlarge\", \"r5.4xlarge\", \"r5.8xlarge\", \"r5.large\", \"r5.xlarge\", \"t3.2xlarge\", \"t3.large\", \"t3.medium\", \"t3.micro\", \"t3.nano\", \"t3.small\", \"t3.xlarge\" ],\n        \"ConstraintDescription\" : \"Choose an instance type (m5.large or larger is recommended).\",\n        \"Default\" : \"m5.large\"\n      },\n      \"VaultNumberOfKeys\" : {\n        \"Type\" : \"String\",\n        \"Default\" : \"5\",\n        \"AllowedPattern\" : \"^([1-9]|[1-8][0-9]|9[0-9])$\",\n        \"ConstraintDescription\" : \"Must be a value in the range 1-99.\",\n        \"Description\" : \"Number of unseal keys to create for HashiCorp Vault.\"\n      },\n      \"VaultNumberOfKeysForUnseal\" : {\n        \"Type\" : \"String\",\n        \"Default\" : \"3\",\n        \"AllowedPattern\" : \"^([1-9]|[1-8][0-9]|9[0-9])$\",\n        \"ConstraintDescription\" : \"Must be a value in the range 1-99.\",\n        \"Description\" : \"Number of keys required to unseal HashiCorp Vault.\"\n      },\n      \"VaultClientRoleName\" : {\n        \"Type\" : \"String\",\n        \"Default\" : \"client-role-iam\",\n        \"MinLength\" : \"3\",\n        \"ConstraintDescription\" : \"This identifier should be at least 3 characters in length.\",\n        \"Description\" : \"The HashiCorp Vault name for the AWS IAM Role.\"\n      },\n      \"VaultVersion\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"Specify which version of HashiCorp Vault to install.\",\n        \"Default\" : \"1.6.1\",\n        \"AllowedValues\" : [ \"1.5.5\", \"1.6.1\" ]\n      },\n      \"LoadBalancerType\" : {\n        \"Type\" : \"String\",\n        \"Default\" : \"Internal\",\n        \"Description\" : \"Specify if the load balancer for HashiCorp Vault is internal or external.\",\n        \"AllowedValues\" : [ \"Internal\", \"External\" ]\n      },\n      \"DomainName\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"Fully qualified domain name for the HashiCorp Vault load balancer. If you don't provide a value for ACMSSLCertificateArn, use the HostedZoneID.\",\n        \"MaxLength\" : 128,\n        \"Default\" : \"\"\n      },\n      \"HostedZoneID\" : {\n        \"Type\" : \"String\",\n        \"Description\" : \"Route 53-hosted zone ID of the domain name. If you don't provide an ACMSSLCertificateArn value, the Quick Start creates the ACM certificate for you using HostedZoneID in conjunction with DomainName.\",\n        \"Default\" : \"\"\n      },\n      \"ACMSSLCertificateArn\" : {\n        \"Description\" : \"Amazon Resource Name (ARN) of the load balancer's SSL certificate. If you don't provide values for DomainName and HostedZoneID, provide a value for ACMSSLCertificateArn.\",\n        \"Type\" : \"String\",\n        \"Default\" : \"\"\n      },\n      \"VaultKubernetesEnable\" : {\n        \"Description\" : \"Enables Kubernetes authentication and creates a Kubernetes authentication role.\",\n        \"Type\" : \"String\",\n        \"Default\" : \"false\",\n        \"AllowedValues\" : [ \"true\", \"false\" ]\n      },\n      \"VaultKubernetesRoleName\" : {\n        \"Description\" : \"Internal Vault name for the Kubernetes authentication role.\",\n        \"Type\" : \"String\",\n        \"Default\" : \"kube-auth-role\"\n      },\n      \"VaultKubernetesHostURL\" : {\n        \"Description\" : \"URL of Kubernetes cluster (e.g., https://192.168.99.100:8443).\",\n        \"Type\" : \"String\"\n      },\n      \"VaultKubernetesCertificate\" : {\n        \"Description\" : \"AWS SSM Parameter containing a base64-encoded PEM CA certificate of the Kubernetes cluster service account.\",\n        \"Default\" : \"\",\n        \"Type\" : \"String\"\n      },\n      \"VaultKubernetesJWT\" : {\n        \"Description\" : \"AWS SSM Secure Parameter containing a base64-encoded JWT token of the Kubernetes cluster service account.\",\n        \"Default\" : \"\",\n        \"Type\" : \"String\"\n      },\n      \"VaultKubernetesServiceAccount\" : {\n        \"Description\" : \"Name of Kubernetes service account.\",\n        \"Default\" : \"vault-auth\",\n        \"Type\" : \"String\"\n      },\n      \"VaultKubernetesNameSpace\" : {\n        \"Description\" : \"Vault namespace of Kubernetes service account.\",\n        \"Default\" : \"default\",\n        \"Type\" : \"String\"\n      },\n      \"VaultKubernetesPolicies\" : {\n        \"Description\" : \"Vault policies for Kubernetes service account.\",\n        \"Default\" : \"default\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"VPCStack\" : {\n        \"Metadata\" : {\n          \"cfn-lint\" : {\n            \"config\" : {\n              \"ignore_checks\" : [ \"W9198\" ]\n            }\n          }\n        },\n        \"Properties\" : {\n          \"Parameters\" : {\n            \"AvailabilityZones\" : {\n              \"Fn::Join\" : [ \",\", {\n                \"Ref\" : \"AvailabilityZones\"\n              } ]\n            },\n            \"KeyPairName\" : {\n              \"Ref\" : \"KeyPairName\"\n            },\n            \"NumberOfAZs\" : \"3\",\n            \"PrivateSubnet1ACIDR\" : {\n              \"Ref\" : \"PrivateSubnet1CIDR\"\n            },\n            \"PrivateSubnet2ACIDR\" : {\n              \"Ref\" : \"PrivateSubnet2CIDR\"\n            },\n            \"PrivateSubnet3ACIDR\" : {\n              \"Ref\" : \"PrivateSubnet3CIDR\"\n            },\n            \"PublicSubnet1CIDR\" : {\n              \"Ref\" : \"PublicSubnet1CIDR\"\n            },\n            \"PublicSubnet2CIDR\" : {\n              \"Ref\" : \"PublicSubnet2CIDR\"\n            },\n            \"PublicSubnet3CIDR\" : {\n              \"Ref\" : \"PublicSubnet3CIDR\"\n            },\n            \"VPCCIDR\" : {\n              \"Ref\" : \"VPCCIDR\"\n            }\n          },\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : [ \"https://${S3Bucket}.s3.${S3Region}.${AWS::URLSuffix}/${QSS3KeyPrefix}submodules/quickstart-aws-vpc/templates/aws-vpc.template\", {\n              \"S3Region\" : {\n                \"Fn::If\" : [ \"UsingDefaultBucket\", {\n                  \"Ref\" : \"AWS::Region\"\n                }, {\n                  \"Ref\" : \"QSS3BucketRegion\"\n                } ]\n              },\n              \"S3Bucket\" : {\n                \"Fn::If\" : [ \"UsingDefaultBucket\", {\n                  \"Fn::Sub\" : \"${QSS3BucketName}-${AWS::Region}\"\n                }, {\n                  \"Ref\" : \"QSS3BucketName\"\n                } ]\n              }\n            } ]\n          }\n        },\n        \"Type\" : \"AWS::CloudFormation::Stack\"\n      },\n      \"LinuxBastionHostStack\" : {\n        \"Metadata\" : {\n          \"cfn-lint\" : {\n            \"config\" : {\n              \"ignore_checks\" : [ \"W9198\" ]\n            }\n          }\n        },\n        \"Properties\" : {\n          \"Parameters\" : {\n            \"BastionAMIOS\" : \"Ubuntu-Server-20.04-LTS-HVM\",\n            \"EnableTCPForwarding\" : \"true\",\n            \"KeyPairName\" : {\n              \"Ref\" : \"KeyPairName\"\n            },\n            \"NumBastionHosts\" : {\n              \"Ref\" : \"NumBastionHosts\"\n            },\n            \"PublicSubnet1ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PublicSubnet1ID\" ]\n            },\n            \"PublicSubnet2ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PublicSubnet2ID\" ]\n            },\n            \"QSS3BucketName\" : {\n              \"Ref\" : \"QSS3BucketName\"\n            },\n            \"QSS3BucketRegion\" : {\n              \"Ref\" : \"QSS3BucketRegion\"\n            },\n            \"QSS3KeyPrefix\" : {\n              \"Fn::Sub\" : \"${QSS3KeyPrefix}submodules/quickstart-linux-bastion/\"\n            },\n            \"RemoteAccessCIDR\" : {\n              \"Ref\" : \"AccessCIDR\"\n            },\n            \"VPCID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.VPCID\" ]\n            }\n          },\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : [ \"https://${S3Bucket}.s3.${S3Region}.${AWS::URLSuffix}/${QSS3KeyPrefix}submodules/quickstart-linux-bastion/templates/linux-bastion.template\", {\n              \"S3Region\" : {\n                \"Fn::If\" : [ \"UsingDefaultBucket\", {\n                  \"Ref\" : \"AWS::Region\"\n                }, {\n                  \"Ref\" : \"QSS3BucketRegion\"\n                } ]\n              },\n              \"S3Bucket\" : {\n                \"Fn::If\" : [ \"UsingDefaultBucket\", {\n                  \"Fn::Sub\" : \"${QSS3BucketName}-${AWS::Region}\"\n                }, {\n                  \"Ref\" : \"QSS3BucketName\"\n                } ]\n              }\n            } ]\n          }\n        },\n        \"Type\" : \"AWS::CloudFormation::Stack\"\n      },\n      \"HashiCorpVaultStack\" : {\n        \"Type\" : \"AWS::CloudFormation::Stack\",\n        \"Properties\" : {\n          \"TemplateURL\" : {\n            \"Fn::Sub\" : [ \"https://${S3Bucket}.s3.${S3Region}.${AWS::URLSuffix}/${QSS3KeyPrefix}templates/quickstart-hashicorp-vault.template\", {\n              \"S3Region\" : {\n                \"Fn::If\" : [ \"UsingDefaultBucket\", {\n                  \"Ref\" : \"AWS::Region\"\n                }, {\n                  \"Ref\" : \"QSS3BucketRegion\"\n                } ]\n              },\n              \"S3Bucket\" : {\n                \"Fn::If\" : [ \"UsingDefaultBucket\", {\n                  \"Fn::Sub\" : \"${QSS3BucketName}-${AWS::Region}\"\n                }, {\n                  \"Ref\" : \"QSS3BucketName\"\n                } ]\n              }\n            } ]\n          },\n          \"Parameters\" : {\n            \"VaultAMIOS\" : {\n              \"Ref\" : \"VaultAMIOS\"\n            },\n            \"BastionSecurityGroupID\" : {\n              \"Fn::GetAtt\" : [ \"LinuxBastionHostStack\", \"Outputs.BastionSecurityGroupID\" ]\n            },\n            \"PrivateSubnet1ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PrivateSubnet1AID\" ]\n            },\n            \"PrivateSubnet2ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PrivateSubnet2AID\" ]\n            },\n            \"PrivateSubnet3ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PrivateSubnet3AID\" ]\n            },\n            \"PublicSubnet1ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PublicSubnet1ID\" ]\n            },\n            \"PublicSubnet2ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PublicSubnet2ID\" ]\n            },\n            \"PublicSubnet3ID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.PublicSubnet3ID\" ]\n            },\n            \"QSS3BucketName\" : {\n              \"Ref\" : \"QSS3BucketName\"\n            },\n            \"QSS3BucketRegion\" : {\n              \"Ref\" : \"QSS3BucketRegion\"\n            },\n            \"QSS3KeyPrefix\" : {\n              \"Ref\" : \"QSS3KeyPrefix\"\n            },\n            \"AccessCIDR\" : {\n              \"Ref\" : \"AccessCIDR\"\n            },\n            \"VPCID\" : {\n              \"Fn::GetAtt\" : [ \"VPCStack\", \"Outputs.VPCID\" ]\n            },\n            \"VPCCIDR\" : {\n              \"Ref\" : \"VPCCIDR\"\n            },\n            \"KeyPairName\" : {\n              \"Ref\" : \"KeyPairName\"\n            },\n            \"VaultVersion\" : {\n              \"Ref\" : \"VaultVersion\"\n            },\n            \"VaultInstanceType\" : {\n              \"Ref\" : \"VaultInstanceType\"\n            },\n            \"VaultClientNodes\" : {\n              \"Ref\" : \"VaultClientNodes\"\n            },\n            \"VaultServerNodes\" : {\n              \"Ref\" : \"VaultServerNodes\"\n            },\n            \"VaultNumberOfKeys\" : {\n              \"Ref\" : \"VaultNumberOfKeys\"\n            },\n            \"VaultNumberOfKeysForUnseal\" : {\n              \"Ref\" : \"VaultNumberOfKeysForUnseal\"\n            },\n            \"VaultClientRoleName\" : {\n              \"Ref\" : \"VaultClientRoleName\"\n            },\n            \"DomainName\" : {\n              \"Ref\" : \"DomainName\"\n            },\n            \"HostedZoneID\" : {\n              \"Ref\" : \"HostedZoneID\"\n            },\n            \"ACMSSLCertificateArn\" : {\n              \"Ref\" : \"ACMSSLCertificateArn\"\n            },\n            \"LoadBalancerType\" : {\n              \"Ref\" : \"LoadBalancerType\"\n            },\n            \"VaultKubernetesEnable\" : {\n              \"Ref\" : \"VaultKubernetesEnable\"\n            },\n            \"VaultKubernetesRoleName\" : {\n              \"Ref\" : \"VaultKubernetesRoleName\"\n            },\n            \"VaultKubernetesHostURL\" : {\n              \"Ref\" : \"VaultKubernetesHostURL\"\n            },\n            \"VaultKubernetesJWT\" : {\n              \"Ref\" : \"VaultKubernetesJWT\"\n            },\n            \"VaultKubernetesCertificate\" : {\n              \"Ref\" : \"VaultKubernetesCertificate\"\n            },\n            \"VaultKubernetesServiceAccount\" : {\n              \"Ref\" : \"VaultKubernetesServiceAccount\"\n            },\n            \"VaultKubernetesNameSpace\" : {\n              \"Ref\" : \"VaultKubernetesNameSpace\"\n            },\n            \"VaultKubernetesPolicies\" : {\n              \"Ref\" : \"VaultKubernetesPolicies\"\n            }\n          }\n        }\n      }\n    },\n    \"Outputs\" : {\n      \"BastionHost\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"LinuxBastionHostStack\", \"Outputs.EIP1\" ]\n        },\n        \"Description\" : \"The IP Address of the Bastion host.\"\n      },\n      \"VaultClientRoleId\" : {\n        \"Value\" : {\n          \"Ref\" : \"VaultClientRoleName\"\n        },\n        \"Description\" : \"The HashiCorp Vault identifier of the AWS client role.\"\n      },\n      \"VaultClientIAMRoleArn\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultClientIAMRoleArn\" ]\n        },\n        \"Description\" : \"The ARN of the AWS IAM role linked to HashiCorp Vault.\"\n      },\n      \"VaultClientIAMRoleName\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultClientIAMRoleName\" ]\n        },\n        \"Description\" : \"The name of the AWS IAM role linked to HashiCorp Vault.\"\n      },\n      \"VaultSecret\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultSecret\" ]\n        },\n        \"Description\" : \"The AWS Secrets Manager Secret containing the ROOT TOKEN and Recovery Secret for HashiCorp Vault.\"\n      },\n      \"VaultKMSKeyId\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultKMSKeyId\" ]\n        },\n        \"Description\" : \"The AWS KMS Key used to Auto Unseal HashiCorp Vault and encrypt the ROOT TOKEN and Recovery Secret.\"\n      },\n      \"VaultKMSKeyArn\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultKMSKeyArn\" ]\n        },\n        \"Description\" : \"The AWS KMS Key used to Auto Unseal HashiCorp Vault and encrypt the ROOT TOKEN and Recovery Secret.\"\n      },\n      \"VaultLoadBalancer\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultLoadBalancer\" ]\n        },\n        \"Description\" : \"HashiCorp Vault Load Balancer address\"\n      },\n      \"VaultAuditLogGroup\" : {\n        \"Value\" : {\n          \"Fn::GetAtt\" : [ \"HashiCorpVaultStack\", \"Outputs.VaultAuditLogGroup\" ]\n        },\n        \"Description\" : \"CloudWatch Log Group where the HashiCorp Vault audit logs are recorded\"\n      }\n    },\n    \"Rules\" : {\n      \"DomainNamePresentWithHostedID\" : {\n        \"RuleCondition\" : {\n          \"Fn::Equals\" : [ {\n            \"Ref\" : \"HostedZoneID\"\n          }, \"\" ]\n        },\n        \"Assertions\" : [ {\n          \"Assert\" : {\n            \"Fn::Not\" : [ {\n              \"Fn::Equals\" : [ {\n                \"Ref\" : \"DomainName\"\n              }, \"\" ]\n            } ]\n          },\n          \"AssertDescription\" : \"Please specify a 'Domain Name' if you specify 'Route 53 Hosted Zone ID'\"\n        } ]\n      },\n      \"HostedIDPresentWithDomainName\" : {\n        \"RuleCondition\" : {\n          \"Fn::Equals\" : [ {\n            \"Ref\" : \"DomainName\"\n          }, \"\" ]\n        },\n        \"Assertions\" : [ {\n          \"Assert\" : {\n            \"Fn::Not\" : [ {\n              \"Fn::Equals\" : [ {\n                \"Ref\" : \"HostedZoneID\"\n              }, \"\" ]\n            } ]\n          },\n          \"AssertDescription\" : \"Please specify a 'Route 53 Hosted Zone ID' if you specify 'Domain Name'\"\n        } ]\n      },\n      \"GenerateOrProvideSSL\" : {\n        \"RuleCondition\" : {\n          \"Fn::Not\" : [ {\n            \"Fn::Equals\" : [ {\n              \"Ref\" : \"ACMSSLCertificateArn\"\n            }, \"\" ]\n          } ]\n        },\n        \"Assertions\" : [ {\n          \"Assert\" : {\n            \"Fn::And\" : [ {\n              \"Fn::Equals\" : [ {\n                \"Ref\" : \"HostedZoneID\"\n              }, \"\" ]\n            }, {\n              \"Fn::Equals\" : [ {\n                \"Ref\" : \"DomainName\"\n              }, \"\" ]\n            } ]\n          },\n          \"AssertDescription\" : \"Using an SSL certificate is enforced. A CertificateArn or a HostedZoneID and Domain Name must be provided.\"\n        } ]\n      },\n      \"NoLoadBalancerInfoSupplied\" : {\n        \"Assertions\" : [ {\n          \"Assert\" : {\n            \"Fn::Or\" : [ {\n              \"Fn::Not\" : [ {\n                \"Fn::Equals\" : [ {\n                  \"Ref\" : \"HostedZoneID\"\n                }, \"\" ]\n              } ]\n            }, {\n              \"Fn::Not\" : [ {\n                \"Fn::Equals\" : [ {\n                  \"Ref\" : \"ACMSSLCertificateArn\"\n                }, \"\" ]\n              } ]\n            }, {\n              \"Fn::Not\" : [ {\n                \"Fn::Equals\" : [ {\n                  \"Ref\" : \"DomainName\"\n                }, \"\" ]\n              } ]\n            } ]\n          },\n          \"AssertDescription\" : \"Using an SSL certificate is enforced. A CertificateArn or a HostedZoneID and Domain Name must be provided.\"\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2021-06-29T01:49:28.554Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "CloudFormation"
  },
  "DocumentVersion": "1",
  "Name": "AWSQuickStarts-HashicorpVault",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "4923a129-70bf-4a86-a93b-a8bac1dea18a",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 31009,
  "HttpStatusCode": 200,
  "LoggedAt": "2022-05-30T07:15:30.7353373+00:00"
}
