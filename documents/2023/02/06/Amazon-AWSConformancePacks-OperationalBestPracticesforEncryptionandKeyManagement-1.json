{
  "AttachmentsContent": [],
  "Content": "{\n  \"schemaVersion\" : \"1.0\",\n  \"description\" : \"Operational Best Practices for Encryption and Key Management\",\n  \"templateBody\" : {\n    \"Parameters\" : {\n      \"AcmCertificateExpirationCheckParamDaysToExpiration\" : {\n        \"Default\" : \"90\",\n        \"Type\" : \"String\"\n      },\n      \"IamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Default\" : \"kms:Decrypt,kms:ReEncryptFrom\",\n        \"Type\" : \"String\"\n      },\n      \"IamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Default\" : \"kms:Decrypt,kms:ReEncryptFrom\",\n        \"Type\" : \"String\"\n      }\n    },\n    \"Resources\" : {\n      \"AcmCertificateExpirationCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"acm-certificate-expiration-check\",\n          \"InputParameters\" : {\n            \"daysToExpiration\" : {\n              \"Fn::If\" : [ \"acmCertificateExpirationCheckParamDaysToExpiration\", {\n                \"Ref\" : \"AcmCertificateExpirationCheckParamDaysToExpiration\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ACM::Certificate\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ACM_CERTIFICATE_EXPIRATION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"AlbHttpToHttpsRedirectionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"alb-http-to-https-redirection-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ALB_HTTP_TO_HTTPS_REDIRECTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ApiGwCacheEnabledAndEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-cache-enabled-and-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_CACHE_ENABLED_AND_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ApiGwSslEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"api-gw-ssl-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ApiGateway::Stage\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"API_GW_SSL_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudTrailEncryptionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloud-trail-encryption-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUD_TRAIL_ENCRYPTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CloudwatchLogGroupEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cloudwatch-log-group-encrypted\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CLOUDWATCH_LOG_GROUP_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"CmkBackingKeyRotationEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"cmk-backing-key-rotation-enabled\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"CMK_BACKING_KEY_ROTATION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"DynamodbTableEncryptedKms\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"dynamodb-table-encrypted-kms\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::DynamoDB::Table\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"DYNAMODB_TABLE_ENCRYPTED_KMS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Ec2EbsEncryptionByDefault\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"ec2-ebs-encryption-by-default\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EC2_EBS_ENCRYPTION_BY_DEFAULT\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EfsEncryptedCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"efs-encrypted-check\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"EFS_ENCRYPTED_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticsearchEncryptedAtRest\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticsearch-encrypted-at-rest\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICSEARCH_ENCRYPTED_AT_REST\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElasticsearchNodeToNodeEncryptionCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elasticsearch-node-to-node-encryption-check\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Elasticsearch::Domain\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbAcmCertificateRequired\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-acm-certificate-required\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancing::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_ACM_CERTIFICATE_REQUIRED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"ElbTlsHttpsListenersOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elb-tls-https-listeners-only\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::ElasticLoadBalancing::LoadBalancer\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELB_TLS_HTTPS_LISTENERS_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"Elbv2AcmCertificateRequired\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"elbv2-acm-certificate-required\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ELBV2_ACM_CERTIFICATE_REQUIRED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"EncryptedVolumes\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"encrypted-volumes\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::EC2::Volume\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"ENCRYPTED_VOLUMES\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamCustomerPolicyBlockedKmsActions\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-customer-policy-blocked-kms-actions\",\n          \"InputParameters\" : {\n            \"blockedActionsPatterns\" : {\n              \"Fn::If\" : [ \"iamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\", {\n                \"Ref\" : \"IamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Policy\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_CUSTOMER_POLICY_BLOCKED_KMS_ACTIONS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"IamInlinePolicyBlockedKmsActions\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"iam-inline-policy-blocked-kms-actions\",\n          \"InputParameters\" : {\n            \"blockedActionsPatterns\" : {\n              \"Fn::If\" : [ \"iamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\", {\n                \"Ref\" : \"IamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n              }, {\n                \"Ref\" : \"AWS::NoValue\"\n              } ]\n            }\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::IAM::Group\", \"AWS::IAM::Role\", \"AWS::IAM::User\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"IAM_INLINE_POLICY_BLOCKED_KMS_ACTIONS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"KmsCmkNotScheduledForDeletion\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"kms-cmk-not-scheduled-for-deletion\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::KMS::Key\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"KMS_CMK_NOT_SCHEDULED_FOR_DELETION\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsSnapshotEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-snapshot-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBSnapshot\", \"AWS::RDS::DBClusterSnapshot\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_SNAPSHOT_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RdsStorageEncrypted\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"rds-storage-encrypted\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::RDS::DBInstance\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"RDS_STORAGE_ENCRYPTED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterConfigurationCheck\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-configuration-check\",\n          \"InputParameters\" : {\n            \"clusterDbEncrypted\" : \"true\",\n            \"loggingEnabled\" : \"true\"\n          },\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_CONFIGURATION_CHECK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftClusterKmsEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-cluster-kms-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_CLUSTER_KMS_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"RedshiftRequireTlsSsl\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"redshift-require-tls-ssl\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::Redshift::Cluster\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"REDSHIFT_REQUIRE_TLS_SSL\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketServerSideEncryptionEnabled\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-server-side-encryption-enabled\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3BucketSslRequestsOnly\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-bucket-ssl-requests-only\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_BUCKET_SSL_REQUESTS_ONLY\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"S3DefaultEncryptionKms\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"s3-default-encryption-kms\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::S3::Bucket\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"S3_DEFAULT_ENCRYPTION_KMS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SagemakerEndpointConfigurationKmsKeyConfigured\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sagemaker-endpoint-configuration-kms-key-configured\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SAGEMAKER_ENDPOINT_CONFIGURATION_KMS_KEY_CONFIGURED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SagemakerNotebookInstanceKmsKeyConfigured\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sagemaker-notebook-instance-kms-key-configured\",\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SAGEMAKER_NOTEBOOK_INSTANCE_KMS_KEY_CONFIGURED\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SecretsmanagerUsingCmk\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"secretsmanager-using-cmk\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SecretsManager::Secret\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SECRETSMANAGER_USING_CMK\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      },\n      \"SnsEncryptedKms\" : {\n        \"Properties\" : {\n          \"ConfigRuleName\" : \"sns-encrypted-kms\",\n          \"Scope\" : {\n            \"ComplianceResourceTypes\" : [ \"AWS::SNS::Topic\" ]\n          },\n          \"Source\" : {\n            \"Owner\" : \"AWS\",\n            \"SourceIdentifier\" : \"SNS_ENCRYPTED_KMS\"\n          }\n        },\n        \"Type\" : \"AWS::Config::ConfigRule\"\n      }\n    },\n    \"Conditions\" : {\n      \"acmCertificateExpirationCheckParamDaysToExpiration\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"AcmCertificateExpirationCheckParamDaysToExpiration\"\n          } ]\n        } ]\n      },\n      \"iamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamCustomerPolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n          } ]\n        } ]\n      },\n      \"iamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\" : {\n        \"Fn::Not\" : [ {\n          \"Fn::Equals\" : [ \"\", {\n            \"Ref\" : \"IamInlinePolicyBlockedKmsActionsParamBlockedActionsPatterns\"\n          } ]\n        } ]\n      }\n    }\n  }\n}",
  "CreatedDate": "2022-08-25T22:48:35.434Z",
  "DisplayName": null,
  "DocumentFormat": {
    "Value": "JSON"
  },
  "DocumentType": {
    "Value": "ConformancePackTemplate"
  },
  "DocumentVersion": "1",
  "Name": "AWSConformancePacks-OperationalBestPracticesforEncryptionandKeyManagement",
  "Requires": [],
  "ReviewStatus": null,
  "Status": {
    "Value": "Active"
  },
  "StatusInformation": null,
  "VersionName": null,
  "ResponseMetadata": {
    "RequestId": "b81de9c9-8fb7-4453-b81d-216335611d85",
    "Metadata": {},
    "ChecksumAlgorithm": 0,
    "ChecksumValidationStatus": 0
  },
  "ContentLength": 16371,
  "HttpStatusCode": 200,
  "LoggedAt": "2023-02-06T07:11:47.9964661+00:00"
}
